var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
/// <reference path="../libs/core/enums.d.ts"/>
var pxsim;
(function (pxsim) {
    var loops;
    (function (loops) {
        /**
         * Repeats the code forever in the background. On each iteration, allows other code to run.
         * @param body the code to repeat
         */
        //% help=functions/forever weight=55 blockGap=8
        //% blockId=device_forever block="forever" 
        function forever(body) {
            pxsim.runtimeStateFactory().isOnDetecting = false;
            pxsim.thread.forever(body);
        }
        loops.forever = forever;
        /**
         * Pause for the specified time in milliseconds
         * @param ms how long to pause for, eg: 100, 200, 500, 1000, 2000
         */
        //% help=functions/pause weight=54
        //% block="pause (ms) %pause" blockId=device_pause
        function pauseAsync(ms) {
            return Promise.delay(ms);
        }
        loops.pauseAsync = pauseAsync;
    })(loops = pxsim.loops || (pxsim.loops = {}));
})(pxsim || (pxsim = {}));
function logMsg(m) { console.log(m); }
var pxsim;
(function (pxsim) {
    var console;
    (function (console) {
        /**
         * Print out message
         */
        //% 
        function log(msg) {
            logMsg("CONSOLE: " + msg);
            // why doesn't that work?
            pxsim.runtimeStateFactory().writeSerial(msg + "\n");
        }
        console.log = log;
    })(console = pxsim.console || (pxsim.console = {}));
})(pxsim || (pxsim = {}));
var pxsim;
(function (pxsim) {
    var Sprite = (function () {
        function Sprite() {
            /**
             * The X-coordiante
             */
            //%
            this.x = Math.random() * 400;
            /**
             * The Y-coordiante
             */
            //%
            this.y = 0;
            /**
             * The radius
             */
            //%
            this.r = 20;
        }
        return Sprite;
    }());
    pxsim.Sprite = Sprite;
})(pxsim || (pxsim = {}));
/**
 * Created by chendi on 2/12/17.
 */
var pxsim;
(function (pxsim) {
    var augmentedReality;
    (function (augmentedReality) {
        /**
         * Draw face outline
         */
        //% weight=90
        //% block="draw face outline" blockId="face_outline"
        function drawFaceOutlineAsync() {
            return pxsim.runtimeStateFactory().drawFaceOutlineAsync();
        }
        augmentedReality.drawFaceOutlineAsync = drawFaceOutlineAsync;
        /**
         * Draw deformation
         */
        //% block="deform face %deform" blockId="face_deform"
        //% weight=50
        function drawFaceDeformationAsync(deform) {
            switch (deform) {
                case 0 /* unwell */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, 0, 0, 0, 0, 22, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);
                case 1 /* inca */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, -9, 0, -11, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0]);
                case 2 /* cheery */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, -9, 9, -11, 0, 0, 0, 0, 0, 0, 0, -9, 0, 0, 0, 0, 0]);
                case 3 /* dopey */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, 0, 0, 0, 0, 0, -11, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0]);
                case 4 /* longface */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, 0, 0, -15, 0, 0, -12, 0, 0, 0, 0, 0, 0, -7, 0, 0, 5]);
                case 5 /* lucky */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4, 0, -6, 12, 0, 0]);
                case 6 /* overcute */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, 0, 0, 16, 0, -14, 0, 0, 0, 0, 0, -7, 0, 0, 0, 0, 0]);
                case 7 /* aloof */:
                    return pxsim.runtimeStateFactory().drawFaceDeformAsync([0, 0, 0, 0, 0, 0, 0, -8, 0, 0, 0, 0, 0, 0, -2, 0, 0, 10]);
                default:
                    return Promise.delay(100);
            }
        }
        augmentedReality.drawFaceDeformationAsync = drawFaceDeformationAsync;
        /**
         * Add MASKS to faces
         */
        //% weight=90
        //% block="draw mask %mask" blockId="face_mask"
        function drawMasksAsync(mask) {
            switch (mask) {
                case 0 /* ironman */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('ironman');
                case 5 /* audrey */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('audrey');
                case 1 /* average */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('average');
                case 6 /* nicolas_cage */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('cage2');
                case 2 /* monalisa */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('joconde');
                case 3 /* sean_connery */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('SeanConnery');
                case 4 /* skull */:
                    return pxsim.runtimeStateFactory().drawFaceMasksAsync('skull');
                default:
                    return Promise.delay(100);
            }
        }
        augmentedReality.drawMasksAsync = drawMasksAsync;
        /**
         * Face substitution
         */
        //% weight=90
        //% block="face substitution %face" blockId="face_sub"
        function faceSubstitutionLoopAsync(face) {
            switch (face) {
                case 0 /* average */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-average");
                case 1 /* terminator */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-terminator");
                case 2 /* walter */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-walter");
                case 3 /* clooney */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-clooney");
                case 4 /* bieber */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-bieber");
                case 5 /* kim */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-kim");
                case 6 /* rihanna */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-rihanna");
                case 7 /* audrey */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-audrey");
                case 8 /* bill */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-bill");
                case 9 /* connery */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-connery");
                case 10 /* cage */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-cage");
                case 11 /* queen */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-queen");
                case 12 /* obama */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-obama");
                case 13 /* chuck */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-chuck");
                case 14 /* monalisa */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-monalisa");
                case 15 /* scream */:
                    return pxsim.runtimeStateFactory().drawFaceSubstitutionAsync("sub-scream");
                default:
                    return Promise.delay(100);
            }
        }
        augmentedReality.faceSubstitutionLoopAsync = faceSubstitutionLoopAsync;
    })(augmentedReality = pxsim.augmentedReality || (pxsim.augmentedReality = {}));
})(pxsim || (pxsim = {}));
/* -----------------------------------------
 Declare the usage of facial masks.
 -------------------------------------------- */
var MASKS = {
    "average": [[121.92799191984679, 184.19216240419755], [118.74113263254269, 253.7017373484083], [128.07732840700828, 314.0651648786312], [145.50341586402052, 377.3404382903117], [175.0470179047746, 428.3720278198884], [216.26268310246033, 469.2344402538887], [267.42588166495466, 502.128073946532], [323.6864139765614, 512.5053811316307], [381.1889691089136, 499.48530971536445], [429.71357990120225, 463.4214900408549], [467.1292936657478, 421.537754329594], [493.2308725208873, 370.6466670145585], [507.3945907183312, 305.3965374123], [514.1098885852615, 238.51000761747102], [507.2009944162471, 174.7364492942625], [465.59705810723074, 136.75665747531139], [432.10874975324265, 125], [384.15174446143584, 125], [351.54488594535763, 135.22963355336668], [162.16177451030518, 144.72103952617107], [194.70376235949394, 126], [241, 130], [277.5198647210173, 137.82992220884094], [192.5627380181407, 182.35373455399292], [225.1658086004223, 166.85817167285668], [262.9021389237093, 184.72604899079232], [224.82421319031323, 193.62679469584918], [224.9386274222809, 179.73191446260716], [443.75218061508883, 177.1556294105885], [407.36102478935464, 162.1785032964798], [367.3426762945685, 181.37362678808685], [405.2498567443763, 188.75927101523848], [404.863153412407, 173.65270066194788], [314, 170], [277.2539320006613, 252.0592473714927], [258.790607031229, 284.0832945003201], [276.64778558874696, 304.54255347445314], [317.4772090972725, 307.7859653833357], [364.4959193923387, 299.6561959465791], [377.27275089177823, 279.043842539653], [357.1140334647449, 250.14961061471956], [324, 222], [296.770695143374, 295.6331974142146], [350.24114846328195, 290.942330984987], [248.8532880314441, 372.38004806995957], [272.1557077756945, 356.35352520595814], [302.9902196911147, 350.59821534914704], [323.11457426149127, 353.0358352022737], [338.3055779254553, 347.5427982113969], [366.49269601972713, 353.1538257295358], [392.63652105652415, 368.4911974180641], [375.0778975047938, 391.4413420753004], [352.32935954043757, 405.19247889714825], [320.19499419206926, 411.930992226806], [288.9192573286629, 407.35752671668797], [267.61253113280924, 394.527019223827], [286.6817714614754, 382.82667526139215], [320.16223074694074, 385.86502934549657], [359.1212544588326, 380.7487964985724], [361.7270998810554, 365.15603335898066], [322.91210334135167, 367.2901736762333], [280.7920218316411, 368.2798825278876], [320.66814785515174, 277.11007275979364], [206.36606604411398, 171.6086547538323], [247.5375468161923, 170.29657636660522], [246.36866333618227, 191.67729410789994], [205.19888043799355, 189.99033691329964], [429.0603263358775, 166.1691180598579], [386.8504393293843, 166.2774220754911], [384.7938981921405, 186.5701136634426], [426.9983448269614, 184.45786533091854]],
    "joconde": [[266.539778613571, 254.84378898872825], [266.3039097561577, 285.302233189556], [271.19357329466345, 316.3538789507933], [278.7139543521674, 345.15573844972926], [293.15712497356776, 368.9809024015706], [312.64193974141324, 389.09850232246515], [322.13343587641253, 398.3663601209212], [336.9858985066435, 401.49456958745145], [356.87519225850986, 398.5376499254816], [382.97232156668036, 391.79752653535775], [421.61286401088506, 373.50434543677886], [448.74322775690695, 344.0259953810623], [464.77440099078314, 310.71915538180275], [468.2775933241595, 272.2241198406615], [466.74514645738424, 247.20492682906303], [415.26964981149064, 225.8370550250565], [390.13712322351404, 222], [361.92175039938184, 220.2582273389706], [342.2734356138508, 232.04834635926073], [267.7624903928149, 236.00873885152805], [280.88607721372824, 229], [303.9033677258633, 228], [316.6965360192193, 234.20369314639848], [281.57998031880885, 254.77971856631495], [298.953459306752, 246.21641370334032], [315.75345517431316, 254.4516165242651], [296.6631361379687, 258.36486568494297], [301.63327656416925, 252.0239926097512], [398.27491865673994, 249.8954346966754], [380.22403819342355, 243.83584281695727], [357.98660716766716, 253.53119540181672], [378.25469629277825, 255.99515336941278], [382.6139465907322, 249.6433274231842], [328, 253], [314.73794539936216, 301.757722929817], [309.85213116736014, 314.6797549304112], [313.1507370768973, 321.4994076914073], [325.20473159190635, 327.87953636258146], [350.1231795924951, 324.5425216268138], [358.3783946629097, 316.6717252774034], [352.7986254362873, 299.5519517987678], [326, 282], [314.75674487301336, 318.32005216616164], [343.0322275619273, 319.2819917007706], [307.87514392633693, 346.0346979532304], [316.68926117981914, 342.91320569661593], [321.7320399187087, 341.45780089974846], [327.8558316510405, 343.56649844038935], [336.18423231506125, 341.74737597014604], [351.00603891713007, 342.2560527375472], [367.88222498993025, 344.3660717427479], [357.305053617142, 354.4583428810625], [343.5761668856892, 358.8848818975423], [328.82001419900075, 359.1051832365163], [320.36190636746045, 358.71759346010083], [312.61714975606304, 353.5625007817836], [318.4988566294063, 348.1744254793423], [328.6406599928464, 349.73460503451736], [350.2480353796336, 349.6831133201238], [349.5754234743516, 349.5362145583936], [329.32557946752445, 349.67345155068153], [318.2253756678819, 347.9222277142419], [324.4964277572599, 315.63122813643895], [288.26630901657126, 248.99890899333045], [309.3536455351319, 248.83485523505226], [307.7075352919804, 256.40978560947974], [288.62032608071166, 258.5736833679789], [390.2498028902113, 244.8663932568382], [368.1047796233772, 247.18427292360775], [368.62079313091925, 255.76448975973483], [390.7655312307384, 254.4464699123733]],
    "ironman": [[54.132994582809886, 330.2447406482356], [53.94983737338171, 411.6786947731232], [59.50117090734213, 485.54290769879117], [69.05631570910228, 577.6685769791815], [80.73400747239302, 669.2047081882876], [156.52267192878207, 721.5706883991684], [224.03761978834723, 739.1269072358452], [301.4803537679236, 738.2366874355024], [373.4196207112528, 736.6185556997145], [445.4373067968218, 720.1452812831552], [517.3056114476371, 670.5474614197833], [531.7799053755264, 574.1779931382804], [540.681172219442, 487.967223266098], [542.4032150608897, 399.64595333584305], [541.5099369565868, 318.2177239885218], [484.00763535360403, 311.3318445452918], [436.57616449858205, 326.12885038303966], [386.214847801106, 333.2043197182652], [344.39911403378784, 336.7706741289662], [115.84864343665006, 313.35525243241443], [152.60840318917894, 322.7145050535586], [201.39783835228144, 332.29526724516336], [249.58724826191298, 336.53976562323317], [116.48023640991207, 348.8633768136441], [167.9642886955806, 350.9962302246727], [231.6749647028165, 359.48349174177827], [168.11831577303042, 375.4865728177492], [170.07462103025938, 361.76575290725043], [480.7831200700384, 348.57719399476593], [423.78106882269736, 353.08381522791285], [369.5853199174605, 360.3348770905004], [429.2517105029677, 374.978498189726], [428.4672557696136, 361.0310278167258], [298, 363], [253.70821429640165, 456.1515630753871], [232.81854206254127, 493.52915431030885], [250.27449264190767, 519.2760705851281], [294.9905749783811, 522.6580485667231], [340.00710866420684, 520.8077271147647], [357.28424845402884, 493.1349774295837], [336.03221275387335, 457.7253897416814], [296, 407], [270.69780042635847, 507.2277260957476], [320.8265507066314, 506.90809731554305], [219.49207600124322, 603.6108989555861], [236.4148918469843, 589.8509195222699], [267.0123175575189, 590.2653879517876], [302.37639394449644, 589.4456339021824], [337.18338067155105, 591.0755705685021], [366.9537080661368, 591.1696362146871], [383.17030058050824, 601.5027761622135], [366.07822563380967, 614.8268645173376], [336.20759244137867, 615.427540755917], [304.12597029775543, 615.4777558918809], [270.01910167830954, 615.9331065732697], [240.4271869365151, 614.9063722445486], [255.5183417994636, 603.9175341052295], [302.81892822034536, 605.4895650711086], [350.74058301633727, 604.2225054756758], [350.6655959742464, 603.528118265738], [303.78446463916174, 604.3090513544694], [256.409865954666, 603.8790201634539], [298.25175247557996, 482.7822436696597], [141.22182216936852, 346.4270057321846], [206.31948949078424, 356.7387529836485], [202.39427275621864, 368.9872676086593], [136.2964448024117, 368.67555898584044], [454.78000220898934, 348.3276075895992], [398.6821272555564, 355.2080431875895], [398.9194910642594, 369.6579535284187], [466.01878775359233, 368.7792910743897]],
    "skull": [[94.36614797199479, 301.0803014941178], [103.3112341317163, 370.94425891220794], [120.32682383634102, 423.44019820073913], [136.47515990999432, 479.5313526801685], [144.0368892689739, 530.2345465095229], [172.36671158523987, 580.3629853084399], [217.01976787749376, 619.1929480747351], [269.34754914721543, 625.5185645282593], [326.48254316405735, 621.3861472887296], [367.5697682338512, 588.2815093455445], [396.3225813396373, 544.5241298700507], [423.17220298223486, 485.34023789625417], [433.9843247454375, 424.6310467376783], [459.5753658677024, 376.88741971189734], [465.6871064619868, 309.4410229689395], [439.2202424949693, 261.17900856324786], [404.95656878888406, 237.16839138607617], [349.4475953084992, 224.72336816106127], [307.5262703136751, 246.56374069983377], [111.59908955786085, 255.73818792771897], [140.77843006651088, 236.25905776423554], [198.25614310392174, 221.75964368670276], [238.0607640650076, 244.705502740957], [147.51722669161887, 322.2920755920064], [179.96374258674177, 303.20283557208495], [219.89652431504095, 321.63741406437117], [181.93382178127874, 336.62855114616417], [181.67029281471235, 321.84674383355735], [409.08887297158253, 319.49332724817634], [372.08555159755235, 302.6637205310945], [332.21673690859785, 314.25212117506817], [371.9034386455536, 336.7928247239386], [370.73203771018734, 318.2549362647991], [275, 262], [241.49292248091808, 382.6509156918952], [228.65540058230079, 403.67602315679153], [246.4207645046435, 428.633436281585], [281.6262637981823, 429.7101230850766], [320.3090052424696, 429.4111504923561], [337.71957018298144, 408.9834145077307], [324.9443408840292, 383.11655691739367], [277, 336], [262.6247652804272, 418.02062856158705], [305.62131595904475, 419.9849042391749], [192.0888434079335, 501.27870633434], [227.89330220055228, 491.767986224554], [254.82152484033276, 488.28172522414377], [274.58325738122585, 496.93117201682657], [298.6427918040954, 490.9689564164321], [325.48328507490595, 499.3328015524256], [350.42668910649365, 508.3776245292422], [327.3034449428819, 532.1604992353581], [302.413708672554, 539.1078344701017], [266.7645104587291, 540.3023216343349], [237.0072802317868, 530.3260142620247], [215.71258213035736, 519.4068856743318], [222.47713501183063, 502.96356939871526], [278.19882029298384, 511.73001012850216], [321.89078331130554, 511.2982898921548], [318.4792941712966, 518.8634093151715], [277.74782145336667, 522.9574136207773], [230.31017878122015, 512.4917843225409], [281.2762389085891, 407.8752450214805], [163.2415047021451, 306.7465365446632], [202.42996875366381, 307.91977418268493], [204.91393138279884, 330.1328065429834], [161.72396129164846, 332.9605656535211], [394.08708850976745, 308.0776176192674], [354.1514690637372, 305.45718896085043], [349.5616880820385, 328.5223891568975], [391.4980892099413, 331.1427807886423]],
    "SeanConnery": [[109.36614797199479, 146.0803014941178], [113.3112341317163, 166.94425891220794], [119.32682383634102, 192.44019820073913], [124.47515990999432, 218.53135268016848], [135.0368892689739, 237.23454650952294], [153.36671158523987, 258.3629853084399], [168.01976787749376, 267.1929480747351], [187.34754914721543, 269.51856452825933], [208.48254316405732, 266.3861472887296], [230.56976823385122, 254.28150934554446], [252.32258133963728, 228.52412987005079], [257.17220298223486, 206.3402378962542], [258.9843247454375, 180.63104673767828], [258.5753658677024, 155.88741971189734], [257.6871064619868, 133.44102296893945], [239.22024249496928, 123.17900856324786], [224, 120], [202, 129], [189.52627031367516, 133.56374069983377], [117.59908955786086, 139.73818792771897], [127.77843006651088, 132], [146, 132], [165.0607640650076, 134.705502740957], [134.51722669161887, 148.29207559200646], [147.96374258674177, 143.20283557208495], [159.89652431504095, 147.63741406437117], [147.93382178127874, 150.62855114616417], [147.67029281471235, 145.84674383355735], [225.08887297158256, 140.49332724817637], [212.08555159755232, 136.6637205310945], [200.21673690859785, 143.2521211750682], [213.9034386455536, 144.79282472393862], [212.73203771018734, 139.25493626479908], [176, 143], [165.49292248091808, 175.6509156918952], [160.65540058230079, 186.6760231567915], [167.4207645046435, 192.63343628158498], [183.62626379818232, 194.71012308507662], [202.3090052424696, 190.41115049235611], [205.7195701829814, 183.98341450773069], [198.9443408840292, 173.11655691739367], [179, 161], [168.6247652804272, 189.02062856158705], [197.62131595904475, 185.9849042391749], [161.0888434079335, 217.27870633433994], [167.89330220055228, 211.76798622455402], [176.82152484033276, 209.28172522414377], [183.58325738122588, 209.93117201682657], [188.6427918040954, 207.96895641643206], [201.48328507490595, 210.3328015524256], [211.42668910649365, 215.3776245292422], [203.30344494288195, 220.16049923535812], [195.41370867255398, 222.10783447010172], [184.76451045872906, 223.302321634335], [174.00728023178684, 223.32601426202467], [167.71258213035736, 222.40688567433176], [169.47713501183063, 215.96356939871526], [182.19882029298384, 215.73001012850216], [195.89078331130557, 214.2982898921548], [195.47929417129663, 213.86340931517145], [181.74782145336667, 214.95741362077732], [170.31017878122015, 216.49178432254084], [182.2762389085891, 184.8752450214805], [140.2415047021451, 145.7465365446632], [154.42996875366381, 143.9197741826849], [154.91393138279884, 149.13280654298345], [141.72396129164846, 149.9605656535211], [220.08708850976743, 138.07761761926741], [205.15146906373715, 139.45718896085043], [206.5616880820385, 144.52238915689745], [219.4980892099413, 143.1427807886423]],
    "audrey": [[153.74201740403646, 257.58838131299683], [153.1357402459916, 291.61358072852295], [163.92648670097353, 336.6674185987861], [169.05137634628016, 385.1975110609068], [187.6238859708483, 421.2108262322121], [216.686071409745, 444.7519516586696], [252.3126606898006, 465.32269819176895], [283.0811558461883, 470.8182094669599], [310.01372611356055, 468.19451253588267], [343.73964850426626, 447.233158556066], [371.3765378504441, 422.9947341112305], [387.5627292608278, 382.0293105452122], [398.46785237450297, 339.09243674243754], [410.7142207166049, 294.2191807024135], [411.7724614993711, 261.09373588344585], [397.08419909909355, 252.94944754715868], [376, 241], [347.88483875688155, 246], [320.92763554902524, 254.63591882122572], [174.20709387641796, 237.53266499674754], [201, 234], [231, 239], [259.80324104447095, 248.8385932134204], [203.20895380044172, 279.4867045991428], [228.2843062554636, 263.77563604011084], [254.37335751351947, 287.3518288920658], [225.37155395907916, 290.26869393942275], [227.77768051230873, 272.55424007173355], [373.6963908872387, 283.83985580081185], [349.2543124861655, 273.37102031128484], [324.214351960891, 292.0051557657032], [352.73999275494873, 296.13681628226215], [350.0652800779458, 278.7378813418683], [292, 283], [262.7314015757042, 344.55089637183414], [256.09382016348263, 360.28137163294355], [265.43437220076765, 373.7185311578347], [292.84018353954804, 379.51893631975383], [319.5702417532398, 374.9644468251393], [324.6370116978122, 365.5029178767047], [318.03834636609736, 339.5592633568763], [293, 322], [275.91223102812063, 365.3241223928343], [310.9988910215482, 365.94139857304066], [241.36179100195926, 404.57248720067804], [256.244097414399, 399.79192498435566], [275.9545526341606, 397.2506401446753], [289.6156500062133, 402.18658812822247], [305.7363366162922, 398.11786374216797], [318.71091994807995, 402.09809058994574], [332.1507895390563, 406.57790820835453], [317.07898694502654, 420.6784334029229], [303.5975014688257, 430.191159222479], [287.22005286691325, 432.45845823523985], [269.1473100017029, 428.92524246489165], [256.3562958006237, 421.3232920714367], [269.4689541559383, 409.5609803328374], [288.9859238876932, 410.32998112652183], [306.1403256243275, 411.3077976017484], [307.73772138569666, 411.00947047307966], [288.5537974824452, 410.51396287362655], [269.7179313684785, 409.79854206584145], [293.13908085531165, 360.2044576609231], [210.24669344926002, 268.1362929595334], [244.33001418358253, 272.06529726630106], [237.37014577148472, 289.8158253810601], [212.28729137033707, 286.8846525992707], [364.4764146636024, 276.60992312858446], [332.73309300337735, 280.1921291112648], [336.47694784065465, 295.57941207015807], [365.2216557008562, 291.9943008746264]],
    "cage2": [[96.81941282528646, 268.6563333055432], [106.75675954633661, 329.1587405365555], [119.76815459937384, 379.4896985493418], [136.07940076941458, 425.9492772057105], [161.2808692110661, 457.61169473264835], [186.04894852923297, 485.6759001579113], [218.4426767235838, 511.0714335097357], [260.06499742347034, 523.1545996578884], [300.06377090251993, 510.61216792938615], [337.5694959005854, 468.82896175985], [358.97922192378047, 441.54181864835476], [379.42084177310676, 403.390743126405], [388.7955321567646, 351.3090658772298], [390.4262385647278, 299.3698133324318], [384.11810900892965, 242.91856536650718], [348.70738406950056, 224.9829932049514], [321, 222], [284, 222], [248.86954256992664, 228.19206802513366], [119.91233030390185, 255.38702736145385], [138, 245], [175, 236], [211.38447558444696, 237.17956241438634], [144.4884094882825, 271.0334533280929], [166.20253053976617, 258.5182260687953], [190.76818628874074, 264.72493789715475], [166.3651367856651, 273.4746395006701], [167.80450182394694, 265.0556706110155], [324.5406048528901, 251.04296112395667], [299.7419762994943, 241.35048431345442], [272.0486344446429, 254.37413342811146], [300.2779904213152, 258.21350699061486], [299.7261402367746, 247.52288292547877], [230, 247], [202.82098590251388, 333.63541920962166], [197.36529740216793, 360.6074799565433], [211.93043020653712, 374.7216105521087], [243.91457342932796, 376.61574931741393], [273.7931176105319, 368.54185553932047], [283.1924422789671, 346.10700000116907], [273.21255878744284, 326.3419941919277], [235, 309], [216.08956463539755, 366.1198047818831], [262.38157625268843, 360.4765024368325], [200.65672420260339, 425.7113072142362], [210.59591704137958, 418.8310789950973], [226.72952280292276, 414.1586736027959], [245.26202591934208, 416.9013315273323], [261.6743086310934, 412.2506112472961], [283.3509308337543, 410.8975165060922], [302.2287007716769, 414.3759049856237], [288.05687218005096, 428.64611508851056], [272.9046262998521, 439.81519003757444], [251.37714128101143, 448.0168626101829], [229.03794885867393, 446.9574815880215], [217.27491143676224, 438.10808744290716], [225.27828463087235, 425.86527765147576], [246.089531122415, 426.43509210786846], [272.14938117327404, 421.7534010147635], [271.81608729443224, 421.5900960094701], [246.87299073434986, 427.22889777615507], [225.65210985383266, 426.21786917122313], [239.24882409629814, 356.7923548552414], [152.34433274214945, 262.7826049480205], [179.48599280195447, 258.6243674505216], [180.06624281569137, 269.6029915273643], [153.926296458539, 274.75536491866694], [312.6407607999811, 242.7049854510107], [282.89141140599133, 245.36953091106633], [285.6577700037131, 257.30455480892334], [314.4040909797777, 256.634302341433]]
};
/* -----------------------------------------
 Declare the usage of facial substitutions.
 -------------------------------------------- */
var SUBSTITUTION_IMAGES = [
    { "id": "sub-average", "path": "./media/sub/average2_crop.jpg" },
    { "id": "sub-terminator", "path": "./media/sub/terminator_crop.jpg" },
    { "id": "sub-walter", "path": "./media/sub/walter2_crop.jpg" },
    { "id": "sub-clooney", "path": "./media/sub/fragrance-George-Clooney-main_crop.jpg" },
    { "id": "sub-bieber", "path": "./media/sub/Justin-Bieber2_crop.jpg" },
    { "id": "sub-kim", "path": "./media/sub/kim1_crop.jpg" },
    { "id": "sub-rihanna", "path": "./media/sub/ri_1_crop.jpg" },
    { "id": "sub-audrey", "path": "./media/sub/audrey_crop.jpg" },
    { "id": "sub-bill", "path": "./media/sub/bill-murray-snl_crop.jpg" },
    { "id": "sub-connery", "path": "./media/sub/sean_guru2_crop.jpg" },
    { "id": "sub-cage", "path": "./media/sub/cage2_crop.jpg" },
    { "id": "sub-queen", "path": "./media/sub/queen20_crop.jpg" },
    { "id": "sub-obama", "path": "./media/sub/obama4_crop.jpg" },
    { "id": "sub-chuck", "path": "./media/sub/chuck_crop.jpg" },
    { "id": "sub-monalisa", "path": "./media/sub/joconde_crop.jpg" },
    { "id": "sub-scream", "path": "./media/sub/scream_crop.jpg" }
];
var SUBSTITUTION_ANCHORPOINTS = {
    "sub-average": [[26.416248681267973, 69.287261104729708], [24.481184011083002, 109.1589911732479], [29.947934496257105, 148.57677024306452], [40.60811914491601, 185.45355598250219], [58.738097832656997, 216.6373204614957], [81.913770252207783, 237.8126294428132], [109.98606755351314, 257.32753166261085], [146.73017889094805, 264.20702756677571], [176.39901111159972, 257.35535351543069], [205.55603543434725, 238.34973455076488], [230.2355979713912, 210.41080746713624], [246.42195156813636, 177.61588628182037], [256.27933737115922, 136.43585286772219], [257.59862842161016, 101.26962757170907], [254.73574762861881, 63.296736154716768], [231.99351427704215, 39.831219799322724], [211.74886735135794, 29.357561061634286], [185.76946624427666, 32.692120457915841], [164.22794828410485, 39.057255405015212], [46.913242738637145, 44.216922272932521], [67.285057768685547, 32.598869110365555], [94.508786161963428, 34.746232646423401], [114.82786184548833, 39.533999746268229], [65.935953298843103, 69.239210402794683], [84.787589310043472, 58.321913189471772], [107.1385272571674, 69.051184056088701], [84.265668561805413, 74.447322016970119], [86.02844527485162, 66.55652441349649], [215.49276321482714, 66.02198446506911], [194.41225043477402, 56.580567518322354], [173.10349613934835, 67.506651798297085], [193.89655333472706, 70.825843235112714], [194.97190332017632, 64.213669799586413], [140.21544525228168, 50.532541524375866], [115.12210668936649, 112.86816444161286], [106.91733219119472, 128.11159519340237], [116.15332322527513, 140.65598165170533], [143.55679637420633, 142.73810254422773], [167.66884888729888, 137.95626733353842], [177.01070972200523, 125.94118566337217], [167.72534960722709, 111.07005102224311], [141.09391638922847, 89.711267100602939], [125.01121871692496, 134.01776882451776], [158.83114482022663, 132.84441173561655], [98.530013119819074, 181.49830160240677], [114.57531577249451, 172.88988327185314], [130.69321885263625, 168.51487947819879], [140.91575863744487, 170.62230018050224], [150.99524791299294, 168.10359663640762], [166.86355823591094, 171.92886610080987], [186.52748819945225, 179.57395522560827], [172.54811810821857, 193.62104452332397], [161.34374255744575, 203.55652478332667], [143.04951921782722, 206.98995295806665], [122.71362572694508, 202.88542194975037], [109.36831831524565, 194.44995485842813], [121.30529318118789, 187.44959256875671], [141.15688782807084, 190.12567632986739], [161.94486681509784, 187.9983882494468], [161.78346166803792, 178.31913412814549], [141.60005262336557, 178.73596022750081], [121.19014424606702, 179.74550271876572], [142.06000674291235, 125.94776468631429], [74.161858259749053, 61.982126979168953], [99.563603953011338, 61.887044688264439], [97.202478466508737, 72.650836394381287], [74.199064214851546, 73.344884154018885], [204.65317864223729, 59.203268807746532], [180.45823699179422, 60.544222235843449], [183.20168844348697, 70.667846856664895], [204.99820389502713, 70.525790218266522]],
    "sub-monalisa": [[21.539778613571002, 52.843788988728249], [21.30390975615768, 83.302233189555977], [26.193573294663452, 114.35387895079327], [33.713954352167377, 143.15573844972926], [48.157124973567761, 166.98090240157057], [67.641939741413239, 187.09850232246515], [77.133435876412534, 196.36636012092117], [91.98589850664348, 199.49456958745145], [111.87519225850986, 196.53764992548162], [137.97232156668036, 189.79752653535775], [176.61286401088506, 171.50434543677886], [203.74322775690695, 142.02599538106227], [219.77440099078314, 108.71915538180275], [223.27759332415951, 70.224119840661501], [221.74514645738424, 45.204926829063027], [170.26964981149064, 23.837055025056486], [145.13712322351404, 20.0], [116.92175039938184, 18.258227338970613], [97.273435613850779, 30.048346359260734], [22.762490392814925, 34.008738851528051], [35.886077213728242, 27.0], [58.903367725863291, 26.0], [71.696536019219309, 32.203693146398479], [36.57998031880885, 52.779718566314955], [53.953459306751995, 44.216413703340322], [70.75345517431316, 52.451616524265091], [51.663136137968706, 56.36486568494297], [56.63327656416925, 50.02399260975119], [153.27491865673994, 47.895434696675409], [135.22403819342355, 41.835842816957268], [112.98660716766716, 51.531195401816717], [133.25469629277825, 53.995153369412776], [137.61394659073221, 47.643327423184189], [83.0, 51.0], [69.737945399362161, 99.757722929817021], [64.852131167360142, 112.67975493041121], [68.150737076897315, 119.49940769140733], [80.204731591906352, 125.87953636258146], [105.12317959249509, 122.54252162681382], [113.37839466290973, 114.67172527740343], [107.7986254362873, 97.551951798767789], [81.0, 80.0], [69.756744873013361, 116.32005216616164], [98.0322275619273, 117.28199170077062], [62.875143926336932, 144.03469795323042], [71.689261179819141, 140.91320569661593], [76.732039918708722, 139.45780089974846], [82.855831651040489, 141.56649844038935], [91.184232315061251, 139.74737597014604], [106.00603891713007, 140.25605273754718], [122.88222498993025, 142.36607174274792], [112.30505361714199, 152.45834288106249], [98.57616688568919, 156.8848818975423], [83.820014199000752, 157.10518323651632], [75.361906367460449, 156.71759346010083], [67.617149756063043, 151.56250078178363], [73.498856629406305, 146.17442547934229], [83.640659992846395, 147.73460503451736], [105.24803537963362, 147.68311332012382], [104.57542347435162, 147.53621455839362], [84.325579467524449, 147.67345155068153], [73.225375667881906, 145.9222277142419], [79.49642775725988, 113.63122813643895], [43.266309016571256, 46.998908993330446], [64.353645535131875, 46.83485523505226], [62.707535291980378, 54.409785609479741], [43.620326080711664, 56.573683367978902], [145.2498028902113, 42.866393256838194], [123.10477962337723, 45.18427292360775], [123.62079313091925, 53.764489759734829], [145.76553123073842, 52.446469912373288]],
    "sub-clooney": [[19.65959653975213, 58.927187574350853], [19.059936741854031, 84.069187035296466], [26.364149346947656, 116.00569220317783], [34.339224596136916, 150.19366409567897], [51.949088586144939, 181.34522063329388], [73.638843171470569, 200.2313071611942], [104.9963894743268, 212.04560334015787], [130.32250615166865, 213.84925849480038], [158.47042744325807, 206.01251760804871], [179.68180939317455, 189.87495266661051], [195.53125724625511, 170.05389773335617], [207.87916287667588, 150.263348854009], [211.60311756946669, 117.20491197917517], [215.1470951154223, 84.821473309459435], [211.28414850045669, 52.323401046109325], [191.07721405137181, 30.707410618465985], [178.7969744809098, 22.95445734151545], [153.07107270051728, 27.766421832907099], [135.8716261860317, 32.270221237428331], [40.797793860118304, 39.293939439043243], [60.586268390363102, 30.045790597286697], [83.66233092249044, 31.510753402473881], [101.7675287849857, 34.611095156640886], [55.196872088033274, 53.769827607374282], [73.294529697216632, 45.286958022232], [89.789514153589607, 52.475732958470758], [72.029799616216138, 54.79702256052326], [73.546514815544526, 48.155860928669142], [179.57558029610016, 46.278523901086771], [164.08951473989504, 39.553052148086266], [145.25477360830024, 47.559030577914911], [161.67137911336948, 47.743228605976327], [164.5570321919293, 42.316490011681282], [118.51043662636579, 41.615242195145811], [96.145654614985858, 89.83443556968848], [94.3004276388547, 101.2777184101229], [101.14232928754529, 107.81832135048145], [122.23729175986463, 111.54568657278116], [141.40084172004063, 108.09394746664645], [147.43968596286589, 98.605209918840785], [141.38241141848675, 86.81434583236927], [120.24759131986298, 71.477475584982272], [105.22693390782734, 102.2511538638106], [135.71453675842949, 102.69239102174873], [82.106944247692269, 143.22308347546931], [94.109143846121839, 139.40149577652141], [106.89618312823151, 136.60699903750498], [124.88130883248715, 140.90523844977974], [134.21351586850218, 137.56831409555417], [149.88840562683427, 138.81679306685891], [163.03665611069363, 137.94602751042942], [149.12971996396905, 143.88566574722165], [138.33054643604166, 147.00248023661715], [124.44218910312256, 149.23925548490803], [109.37911171081555, 149.45999223240068], [96.652978590522281, 146.671300600503], [107.6988534718862, 143.24503220634898], [125.16408321171812, 142.98263526928565], [143.47086754124314, 141.3936752079527], [150.2625022256851, 140.14425743374363], [124.86889327286275, 143.03426613514421], [107.71038700817618, 140.22310608370606], [121.13865545746836, 97.831789384933728], [63.746229482356711, 47.529221261778929], [83.542252517622927, 46.881351751053245], [80.910117350035449, 53.637093872553805], [63.111222164868025, 54.283991811834312], [173.83311856200004, 41.917012775126381], [152.17209160945234, 42.056325934275009], [153.46358946670941, 47.653634652561493], [171.12694131217529, 47.51275441245707]],
    "sub-bieber": [[19.53711459170038, 54.444293102992319], [22.410358417930311, 81.323108571931471], [32.401607743685382, 122.14228794382235], [40.548237569709926, 160.95800363740622], [55.830864519376661, 195.08306428683375], [81.385287393438929, 223.19377613278513], [112.80248099038053, 245.70922521138434], [143.66759219912683, 248.19456654705792], [170.97838880302498, 243.80815503839696], [202.54366882314216, 219.80900163327027], [229.12024016664279, 189.13313409839208], [244.51837898295568, 147.82841415594618], [248.62248099284733, 110.09427599568797], [252.16065269095574, 69.022615327489461], [251.1869106001711, 38.073482825891446], [223.77766201515098, 30.263843596126286], [197.68549009500683, 27.366877637166382], [172.02508396552125, 31.480903122367078], [150.59332989209975, 39.090254247657896], [38.741981623011633, 42.588528571746735], [54.958919220427802, 38.439293690791018], [80.326672773709362, 36.802767512800102], [105.79165522546174, 40.753572250309261], [59.731070080437199, 61.374403460631441], [82.0248909472554, 52.792320852576772], [102.98174927891796, 61.588233179208871], [81.291210273721063, 63.763521680101718], [82.102587870122846, 57.509244186188191], [202.9918057560875, 54.365166608239129], [183.35185317803828, 47.157748497015682], [161.8385137789503, 57.656333304586035], [183.83907055868855, 57.557394332838136], [183.42545741727207, 52.010032452550263], [131.686076554246, 53.909282900234132], [107.69799915829482, 106.47273945500959], [103.11407801720561, 120.60153702065169], [110.43523698455824, 130.94952817956354], [134.4500665704968, 133.04683073943445], [159.64146874757529, 129.78570852986701], [166.7487844961837, 117.81662059272365], [160.1901896709515, 104.45704674681713], [132.8335797372176, 85.328251842395701], [119.90596285959741, 128.2845201373249], [146.94103038566482, 127.18023554236562], [95.191706081438895, 169.00217518307196], [107.74010091792692, 162.93726104569006], [120.53732776801282, 157.36305081327322], [134.36346005292657, 158.19042577349052], [149.06532629960918, 156.03333668322352], [167.53754920890682, 160.14750809785232], [181.68075634048043, 166.51055859230061], [169.22867544048322, 177.30535719977763], [152.98958831541205, 185.89315973650133], [136.352332183502, 190.0381828867574], [120.88426223614132, 185.79922898421083], [107.35465833211961, 179.72589047488501], [114.79299794468891, 169.92000421669977], [135.13370299082726, 171.30173772478196], [158.39876693773857, 168.34925679955404], [158.23752239371439, 168.04209911043037], [134.80406768396711, 171.32584974562951], [115.32751612180201, 169.70233460348607], [132.43152742593281, 118.83318930228684], [69.123085034678766, 54.985576193750248], [94.253510496854048, 54.393003960509063], [92.485452013800042, 63.026429370670705], [70.154658366398536, 62.923362768598608], [194.57561889878309, 49.363550336040007], [170.8445542308101, 50.310130450256054], [172.48925643335903, 57.608921571249979], [193.42216119777584, 55.967660359955829]],
    "sub-kim": [[26.392953623213501, 74.847347679657105], [26.527141369604511, 113.68851836791519], [37.850280396733659, 153.34202975546106], [48.463148502888259, 198.41912707786042], [68.036605940850848, 230.63187132257846], [93.393921931707482, 256.18460712943767], [125.54962553340661, 277.0006892560142], [159.76888265265634, 283.50936210722568], [190.86251528873004, 273.21633240176328], [215.4823452806404, 246.84486234022947], [236.0322931252845, 221.15226043028213], [250.6507850464711, 189.90684387337964], [258.98554243442391, 147.8303429835579], [265.61657423486696, 111.82570412985555], [263.82649874587986, 67.66214176561175], [254.94521256635076, 37.757625912971747], [235.79466011571427, 28.645231408254602], [204.91596627739196, 32.48320193484367], [178.87856926846536, 45.012565822225127], [42.981527327852305, 45.1931744008115], [65.798535249115119, 30.205697217705545], [104.20469447938497, 38.014705489906277], [132.76130440395275, 47.358258842651956], [65.732837436644772, 73.313719718526713], [91.09303435966045, 62.44640989897627], [117.81003667247734, 77.588938967093213], [91.455791107898818, 78.157832338525793], [91.462070264092233, 70.129658655089131], [237.49694309020128, 70.204758493119016], [212.00252085043883, 60.741643699902738], [186.28991752012382, 75.480800750925113], [213.38992085780873, 75.700650938318205], [211.28408082179848, 66.628969802711069], [155.31681846547161, 61.723254148350158], [131.79242360681408, 132.03519502324014], [125.21093316902153, 145.05754431578387], [131.88896031053739, 158.30278486585388], [159.78089633124134, 160.7729628498802], [182.60204348750557, 155.22867538213509], [188.06987132384856, 142.36052040680599], [182.50935337688247, 131.17112912726614], [157.92771083963791, 101.9554747029501], [139.68757897346234, 150.2800567907548], [174.91470138004024, 149.77535693426591], [108.20772330971123, 199.82539585852084], [127.27495019814955, 190.57647699976485], [143.43128670979286, 183.79198573228979], [157.48346624056376, 187.99166515485183], [169.06090197834246, 183.92606098499843], [183.34853446393896, 189.45691649529616], [199.86559748534597, 195.95084259678697], [189.71112448658715, 213.68218280440522], [178.41365542672253, 224.07658144186891], [158.74710148750472, 231.45074591989936], [138.79163021123412, 228.1686029366403], [118.5034950367303, 215.59047900510384], [134.39528308805779, 203.05726622213831], [159.30274323745374, 209.15248016464469], [175.89464505418053, 201.96972700502886], [176.97487381747911, 198.90143676014918], [156.30097058265304, 198.13847443352608], [134.20235365838741, 199.40444860590469], [160.61948984308634, 139.11949191775341], [76.663536017602837, 65.783911161963701], [109.70319643529164, 68.269206273210557], [104.63389091894381, 76.826187107600873], [79.295001366702479, 77.141208919791538], [228.9531335582283, 64.425761944937264], [197.74571106481017, 63.914007487070201], [200.53834682135945, 75.244684951836774], [226.14466575989266, 72.954228841629359]],
    "sub-bill": [[27.840096322632149, 76.368615990185191], [30.154816021430406, 109.06063400353474], [39.379878405162572, 137.75576812530437], [49.720971343106442, 165.56006971830811], [69.685918962455162, 188.83062502686539], [91.136611503567053, 197.11213236968024], [114.01369602338886, 200.28928696425578], [137.67505607580313, 198.99464477027379], [162.00533931387088, 194.67502878665346], [183.59957539615169, 183.86171397188139], [200.64843069277788, 169.12249458895553], [212.74882015279246, 146.59654529811888], [216.19464878771885, 117.51545219326954], [219.7054153227329, 82.920303627910158], [216.55736851626409, 52.500598145987141], [195.29140690264768, 33.844288891203831], [182.10450082040984, 28.047753816454644], [160.04559543130165, 28.487796821539263], [142.86240187537408, 30.124466843837581], [40.405647296470676, 54.374170928106054], [56.295673096305649, 43.873060994871253], [76.723373554797661, 38.650838700640719], [95.621661762561274, 38.363822770704132], [60.297118828516858, 70.475169555111961], [78.651718472233313, 59.224037348059483], [99.573440037293096, 65.250504005881226], [82.29544502828054, 70.300901108009271], [79.134179987698502, 64.227444036123558], [184.89706951713521, 56.365831102188366], [165.52473664328181, 47.770967481018118], [146.32998667504086, 58.324349203503402], [164.82643203538686, 60.04407203414334], [164.39886888106582, 52.778806963733672], [120.52365835160424, 52.521477554028849], [101.06903113447152, 95.354177230792828], [97.706278577909302, 108.83642847893361], [102.04351853018306, 115.05243108012365], [125.99992209867958, 112.0236401737053], [148.45902991311357, 108.96260829647667], [152.23777198445976, 100.26761218015756], [147.33366694378407, 93.695762370380891], [122.28850921293144, 76.101379473190349], [111.44116718235543, 108.35150088493117], [138.55187585038368, 104.45109866815397], [89.123185296043147, 151.19072505820475], [101.70113856203162, 143.16269317848082], [114.55904368474734, 137.03596375729882], [127.5260977252027, 136.62440720393903], [142.15015468594385, 134.33539281866416], [154.35000323575321, 135.82860430555473], [164.20085849796595, 139.78224358677733], [152.9774542793399, 142.98379202064962], [141.73178221104934, 145.86324454310341], [129.89339680864276, 146.89033084663646], [116.84788403543834, 149.04075275643936], [106.82191699109006, 149.14242258364681], [114.60339284933946, 143.21586094656988], [128.31056675771958, 139.4452901718596], [148.33878241574769, 140.53480603779201], [147.93332321344963, 137.89989048828988], [128.69585663786603, 139.90709643494949], [114.63118953141685, 140.63329768649351], [123.81172998652696, 98.785958550314348], [66.474208747599363, 63.358122307976885], [89.613458219896927, 60.741998702521187], [90.438207912343842, 67.780375024366094], [73.297736628896502, 71.388966880916655], [176.21292587446089, 49.577879569149928], [152.92815791080079, 51.050952892124485], [156.57901529439357, 60.189126505911844], [175.86218001261233, 60.708989122215144]],
    "sub-connery": [[38.892083339257844, 40.568761472443001], [29.90159331543386, 77.650979095829243], [23.528785192881184, 115.12981090320817], [28.511131183389089, 158.48255423521496], [36.942695419670031, 190.0233172264432], [54.458575857371784, 222.14890063102555], [83.272696884783187, 241.32312566364817], [112.34558466601413, 254.34619861333098], [144.58533461942631, 250.67758868401037], [172.20420363672687, 233.81852073557391], [196.39312100566269, 211.34357793943363], [213.39744139863737, 184.73519809603738], [225.21562242547819, 151.80094676818908], [237.24370618259738, 111.68508532117359], [245.37037238466385, 76.747156060247008], [233.37702308878991, 66.751881991182429], [217.53786714161851, 58.032768064935894], [190.31676158270122, 52.308575780288855], [169.41334844892879, 51.226316810323091], [56.207445417444667, 33.067483014583026], [76.722796932348402, 29.047185245786149], [105.73804935320115, 31.249505073127093], [129.41744120282408, 37.429432344589621], [76.681963278187865, 58.350090907959633], [94.19972974921599, 54.756572031752867], [112.85419644295345, 64.415693298960278], [92.812398165291782, 62.397598103038298], [93.655368395257653, 58.161653341144778], [210.96205026792569, 78.004343128986662], [195.75238522801715, 68.76760748433108], [176.43642892509493, 70.224445619890886], [193.68109207192683, 77.087571441960634], [194.70712087330261, 72.862005768658676], [148.20208672391288, 58.342590915631767], [111.1666788930213, 106.63701529362415], [101.34747511120258, 119.12987300043589], [104.18303077659665, 129.20360281985296], [133.37279277423349, 142.748980146029], [157.93432226268496, 141.55894442135795], [168.96130581416642, 132.07242708249322], [164.20633959835496, 118.18083518929345], [144.65602166235658, 92.397726364522015], [115.40494645905375, 126.40789286820008], [157.79608269264335, 134.75702279793697], [85.980010160822758, 162.15639224332949], [101.64943872830327, 158.38505258879277], [118.67438165368489, 160.35871309389356], [130.25722607258859, 165.38673650507471], [143.15742329539017, 165.77052618136571], [157.70242299467066, 172.33499834295802], [169.65543648993273, 175.78855371525023], [160.12055822257562, 188.16869070735714], [148.14213249766502, 194.82664029567607], [123.6042849464561, 194.88227565731569], [107.47564886902663, 189.02099163974216], [92.083113590444754, 178.87228804990815], [107.8070847076981, 175.41059890627554], [127.02743901200465, 178.34303343927226], [145.81970631097616, 178.37106140001052], [152.5287145895322, 172.6301131395058], [130.33035941222428, 168.52457058376751], [107.7206420350132, 162.47051940192065], [139.33872973963111, 126.60083436107105], [83.34288190802836, 55.8538320861296], [106.32865532584162, 59.237712272335273], [104.93444701975285, 63.759204900543274], [84.046862139237973, 61.775258429145531], [205.45785499618236, 72.338141123931806], [185.39496033403927, 66.696155105024673], [185.06364946271444, 74.709457364532881], [201.62551705633905, 78.249786099181634]],
    "sub-cage": [[38.357056558682224, 60.736490607874416], [23.341327901797936, 107.25014599667472], [18.296846321559066, 148.23051012644805], [19.372695643526168, 188.65305377967664], [29.154876750304378, 215.96034564242314], [45.134310349980488, 244.36531182613257], [70.519067923334447, 267.83847469488006], [101.68753084001821, 281.0922742741248], [140.7331873207979, 285.88371876848129], [170.9390562968122, 277.08040962953862], [197.87163563750002, 261.59418146285884], [223.42845954976377, 241.97378591315569], [245.0650088791653, 210.18543074803304], [261.10462533802968, 172.38255310709295], [273.10872642190981, 123.91021190431911], [250.76635857684363, 84.600787431964889], [234.09351530198521, 72.517706680712692], [208.74167260911511, 64.247660836061527], [187.81514700728363, 58.544297226870881], [74.131483122576284, 36.136870472111582], [95.844126758687452, 32.281398321513123], [122.56035690731997, 37.962543427439527], [148.22450319574315, 44.249023213088549], [85.223771071744906, 58.544422052615509], [108.44657180031147, 54.503014392356079], [128.71885243916009, 71.094947200089337], [102.01015040453876, 69.872705287553586], [106.35614075069611, 61.135360036022256], [231.12788939629235, 99.795903411403984], [213.49537287525797, 83.776879991946686], [191.26433579749491, 88.068739788561743], [208.74485262843476, 100.64749621743501], [210.3902447700176, 91.745721437553414], [165.11333999594746, 65.233933098272132], [118.44177482082158, 118.67444264582296], [104.43633090065161, 134.36522676928988], [107.97325108027587, 153.94854060017767], [135.14700490709532, 162.46176003224451], [158.25542163066774, 168.81168710778437], [171.23871364437443, 157.8702716949802], [170.99524963368106, 136.00154408059339], [153.17970711274839, 104.6512535923592], [121.24856419365493, 146.72319602458541], [155.03701415731447, 155.47015160678404], [78.466354770855915, 196.06457566218131], [91.746762577873142, 190.71906729876349], [115.16530841874146, 190.9990107540126], [124.15308474531936, 197.67472452041352], [136.50232294953494, 199.494779982621], [154.59531097066568, 207.60344956896392], [165.2203651574051, 220.13387490642199], [152.12241005492899, 222.37254974396703], [136.95812099553518, 224.79934977608076], [118.62579187860695, 222.04126374309647], [101.43461433730506, 213.44877444745077], [91.126562884160748, 208.42063503351378], [103.31382289348142, 200.40641231858996], [123.70959937134573, 209.25298000999445], [144.3127346555429, 213.11037420816461], [145.01373850122738, 210.64398695827401], [124.5966930093344, 206.77316937277249], [104.34585866228781, 198.00179369859504], [140.87145828311228, 140.52728839936404], [94.034520017012127, 53.724169619451033], [121.73270003511465, 62.449610686083915], [115.01374220523665, 71.184949762616284], [90.815596125430076, 66.659246627086432], [225.11169678544977, 91.787112952908473], [199.92938089835985, 84.173222767668918], [198.25457269780782, 94.35966863611155], [222.73697143561492, 104.07355685539949]],
    "sub-rihanna": [[26.138899461407689, 92.244179099265835], [30.150033619898522, 129.0592834006242], [35.996054826216913, 157.99930474933535], [45.509781735478924, 187.12127271304053], [60.51024161514006, 210.41325200694192], [86.310688149068426, 227.46971998938116], [107.85974681746808, 236.69500599276591], [136.57644554048775, 238.10708866312754], [165.62648705221295, 231.57806683999053], [188.3608395007787, 214.39011511507942], [207.93248607083333, 196.0814225694686], [219.89916920545826, 168.58008860014098], [224.49883040486739, 138.90264901250617], [228.58281464622078, 106.91416429657839], [224.58252481471797, 70.933146993653779], [203.3774978319762, 28.028820808172352], [181.58472787599737, 19.435310158112408], [156.86417294526154, 24.460306030063659], [135.73914402023993, 31.456797488595342], [32.047262797597298, 50.543719104317915], [40.464089467706167, 38.381365394715388], [66.342397552413019, 34.321110135743673], [88.515953347009969, 36.93324860750586], [46.733268642989657, 78.712499539135578], [66.449686483581431, 65.373420492141349], [90.173907195079082, 74.9121559129796], [66.233854603446957, 78.415688222479957], [68.270574612475599, 71.660416916015635], [190.65898690318929, 64.810998305632253], [168.20638484997923, 55.804190409734566], [147.43315449749568, 68.626928898045307], [168.22673344465349, 67.61289342187888], [166.51021546156483, 61.875220550023961], [118.92897147566528, 60.280657952102231], [96.897767488546208, 103.97035633816941], [89.664096235805445, 122.34811624311288], [98.833438666909871, 128.43822554362711], [123.81326752339046, 129.33942642442472], [151.23906851910579, 124.56706552807259], [160.80260431887578, 112.48823512650107], [149.53543511254858, 101.14056094329058], [119.91425590973432, 81.776934802513281], [107.10091816874086, 119.93543263950561], [139.89073855497173, 114.97527848530341], [86.039156734614494, 163.79526897618302], [100.31550207547357, 151.95465454080531], [115.33537786053085, 145.67621375202529], [128.49927701873415, 149.08891090011926], [136.82856091872964, 144.23636993467616], [156.20890091990211, 147.83178979124301], [174.55301109182807, 155.65761972225934], [164.99975808270366, 165.63417075097752], [149.04314047426175, 174.12550564044938], [129.91702711147209, 174.845305670843], [113.34708735522268, 176.24295559630082], [101.03175759253789, 172.44295639648487], [105.93344735335506, 160.34735779820977], [127.43487958488878, 160.81933686724085], [149.58356968953328, 156.11918541420829], [149.5114621251295, 156.3177299583827], [126.90564735939108, 160.6358515740547], [105.55243401686153, 160.0615670038776], [122.24009751272602, 109.67347000836308], [54.593084788445459, 70.431269150370369], [79.107238894532827, 66.533611837568742], [80.595062712249302, 75.052674625787859], [57.682176074481895, 78.957592891796779], [183.02872671333918, 57.096961590684487], [155.0208679018707, 60.611070713694659], [157.0325640646339, 68.513983801624093], [181.04275593545705, 66.607854469117726]],
    "sub-queen": [[23.505386602589198, 50.457444393308663], [23.770997513824113, 79.750010592355807], [27.113644647783133, 107.05392377626163], [35.321303628622132, 136.44305205172321], [47.334549538017711, 159.18765164959615], [64.199292851437008, 177.03373895127152], [84.765625678051379, 191.83108912146804], [109.28402179239941, 196.45906084532959], [135.9359304546071, 190.54807551773638], [160.92638460512586, 174.43015267056262], [180.10178679830051, 153.97905507448695], [192.41726401346494, 126.67359148115031], [197.16242118270173, 101.15454548575792], [197.64413760608852, 70.312868465894098], [192.53172579302651, 41.967007222640632], [169.31080503903837, 22.162418347767982], [154.0273734545479, 18.374726602295368], [133.42613502058202, 22.96266560761353], [120.45410689424983, 25.502895906530568], [31.44546511558309, 31.945208272929221], [46.768848813254607, 23.581632433649531], [66.673207984269141, 24.172974522013021], [81.626067130688511, 27.638789633838883], [47.947701102202586, 47.681543362179184], [60.623376724198778, 41.633656006991998], [79.36915359618331, 45.721067869780654], [62.330186344080488, 51.371860492471512], [62.745750219507102, 45.599559964606215], [158.19258779162885, 45.300672194745914], [140.60340929518344, 38.45229892703685], [125.7806082208532, 46.347477725027204], [142.34288582277316, 50.698235503409762], [142.60871772009955, 44.437882664899462], [99.97940419106925, 41.514879333955264], [82.213624624444435, 82.354789460933432], [75.65401524869975, 96.278063325340668], [82.508445343639551, 102.11984542944111], [101.60744302836173, 105.94037459973111], [122.63043456337431, 99.592250218637901], [129.62786603125369, 93.957718348243077], [118.99818032302022, 81.401385613867888], [100.04956768903412, 67.861677148659396], [86.313389423664717, 98.430691407496624], [115.53309045382008, 97.1560811012248], [70.196138989073745, 129.52006520479512], [82.774122202456056, 125.37454913886643], [95.124174822972009, 124.78123204792121], [103.90869760615385, 126.2571438963663], [111.25150881410894, 123.17288375183074], [127.28656888633316, 124.55474856966089], [144.31109846428922, 128.65315176422104], [133.34586280219827, 140.30073546752016], [120.84012623666604, 147.41887856217244], [107.03519115747525, 149.60767216282352], [91.740550885270409, 146.68583392233438], [80.326767974424286, 141.46630043417008], [88.568623957901309, 136.39444745405399], [105.46004677224801, 140.46140391578234], [123.31897526995601, 138.15333836238494], [122.70288882671514, 128.17663770168849], [103.81577906858274, 129.49492394511066], [86.215486592429272, 129.49235140135801], [100.17418968456138, 92.838046187331713], [53.784991837303153, 43.657281631162277], [70.495495697799754, 42.176471952281418], [72.847366600432451, 48.547152030252391], [54.136195115745608, 50.027845814704847], [150.39702665408328, 39.876052149764064], [131.19169764996349, 40.900020983495949], [133.56176420233407, 49.52351354943147], [149.76874192232191, 48.5000219314216]],
    "sub-obama": [[20.483665550074608, 53.183692860767394], [24.361922673852241, 95.737273870516105], [30.400959413822353, 130.45754077869711], [41.242349718827768, 173.04726502529044], [58.105008569484156, 203.7660013530558], [76.869655382911503, 226.34291300753259], [99.369341611341881, 255.0713395857554], [139.74120550264209, 263.76162554942738], [171.32947217998174, 255.46957428093305], [199.946894095613, 226.62339957345694], [221.49837040108935, 199.79835948444554], [240.08516723936782, 168.18189730988399], [252.08395469198265, 131.21374537265351], [258.36170743521484, 90.380588166058288], [255.10754458650274, 42.584944707292443], [231.75249195960055, 45.327439832074035], [208.7290513846105, 33.264165113810314], [182.45184021795453, 34.887902751598574], [163.08711212720985, 36.03634039159865], [45.239265084152109, 48.306833774880189], [61.461858247924326, 37.834099965504009], [86.827961811524062, 37.197019300749332], [105.91824585785361, 37.88368161363735], [62.860924946003244, 61.188846253618586], [80.619662775077074, 51.747190870172624], [103.93398842852524, 59.997457002440939], [81.751456803195623, 64.255501456018763], [84.004294538216001, 57.077229167297531], [211.98838032569785, 57.593772126059918], [191.5778679580265, 47.983763125242731], [170.38855049276546, 58.461369542688253], [191.9441136281869, 60.225926779697986], [191.92669412372422, 52.579307802528767], [134.66117725008127, 47.998802609275117], [100.70375436244497, 117.18170772223409], [96.359586237232236, 130.97608621290914], [104.08684841884893, 141.69896624605406], [131.24128684772495, 143.97185685417674], [164.76450358310424, 138.26000471129672], [176.92626974984935, 126.08237618839462], [167.22572255493887, 112.72928720583801], [134.0611802462972, 85.717075270380818], [114.33387220509169, 133.05178089828468], [153.76794949662624, 131.67190072058332], [88.866522295425142, 180.54393261075492], [104.46692763753509, 175.38305552650226], [121.43438355304571, 169.84539945272661], [132.37535179506003, 171.81705846390579], [149.18563061624394, 166.35416111906289], [167.16644078199599, 170.78387842411823], [189.16695843585643, 176.57652671573587], [171.83553768789335, 187.7115867136792], [156.33804805643729, 195.81101875373039], [134.27563409833002, 201.38739357915634], [117.15337885298841, 196.70731823359964], [103.96847180524558, 188.68352736101971], [116.76487739956575, 181.44052669308485], [135.74530154751699, 182.90627748639344], [153.63331858186731, 179.62109542567683], [151.88019838003063, 178.74543573334981], [135.17389732718308, 183.56591812464339], [115.77196402700586, 181.24528883502023], [132.4588789817806, 125.30097836947944], [70.691361409540519, 55.425799087708185], [95.074744482330715, 52.724441664122146], [91.093459751654223, 62.828111718395917], [70.206999478716284, 63.420717668699439], [204.23047792617393, 51.746876200870737], [177.48356609989082, 50.074372448180128], [183.61325430243852, 59.696924337487069], [203.36282510792634, 59.961322827348759]],
    "sub-scream": [[31.036290655849882, 57.432857152986685], [36.834032422703402, 76.616090763423301], [44.144879197624306, 91.506035663960802], [56.746870626966768, 106.12350665968165], [63.525573844882473, 121.99269842503458], [69.2934094352062, 141.18816557433274], [79.116034591995231, 158.27345628505338], [95.444768276521444, 157.85798622717158], [112.1506100202503, 149.53119369985041], [120.19223108149427, 133.77442783766503], [120.98364439956012, 118.34214249063547], [126.09006592863452, 102.16079319696235], [136.11638867777555, 90.042725252145431], [143.07386026688062, 75.600333966055501], [143.83480182971522, 54.469443259083619], [133.78044168407791, 38.927078049915451], [116.88883196831546, 29.805997108581423], [100.37012716461871, 31.831740142580585], [85.39723434749834, 42.341129078554331], [40.717793723347995, 43.305563127634542], [48.744681128699852, 37.771923766655192], [57.448931896748704, 36.028754590906701], [67.464345519404787, 36.944607085351322], [45.385363552887199, 58.225754147134666], [54.363960101074014, 47.630931768034003], [68.011017790419004, 54.583990783711471], [58.120050008047329, 62.745638214068549], [55.616718436597296, 53.995790698964527], [122.66684453667131, 54.6831401033742], [110.90016888640474, 45.569147756531351], [96.234198458489033, 53.677715067572848], [108.49190790972344, 62.644313336393992], [110.33329194240295, 54.935130623390222], [80.887741592339665, 51.027213274581243], [76.364796231779138, 68.40676367915853], [71.204026202304306, 77.172050050826158], [75.730620606370721, 82.644032983592723], [87.363757439691426, 80.118716444055792], [98.704261825861266, 80.021192400105463], [100.92981427616351, 75.460833622671146], [93.832797746290964, 66.709039647758487], [82.448627671183701, 59.880239108276982], [78.635928103659296, 73.849587320332546], [92.627257877148452, 73.43767426025039], [79.131242507468116, 114.47649461874275], [77.082061781015526, 104.8161820064411], [76.86256899541047, 91.51976352151155], [84.492130686253887, 87.376289229573757], [89.954070974658805, 90.754539182117583], [96.555921994018263, 100.64436225867991], [98.440888036356, 112.45487645254397], [99.900677251741001, 118.69433160303333], [97.588402646172568, 124.71623282477302], [91.597980889907518, 126.41777298016024], [84.533931967288538, 127.61556713904764], [79.240345390611509, 121.19778971162847], [83.178935170207694, 120.97334887551744], [90.622988915812243, 121.32946906512535], [95.211974749360394, 119.17107481925299], [90.610722471562042, 96.597036966133828], [85.032665543272103, 94.424007443444765], [80.833795006309913, 101.09683414893499], [85.305504524124245, 72.452653823137268], [48.8748794470348, 52.429091513207823], [63.68702721228027, 48.108214917609644], [66.062515145830616, 60.166087383119986], [51.2501982134619, 62.489540249221989], [117.78390022622665, 48.625670298558617], [103.06761868980499, 48.623588434563402], [101.36381278664584, 59.660098601097076], [117.07959483560742, 60.662984572138043]],
    "sub-terminator": [[29.076884732031772, 71.67890495708096], [27.66651993257193, 111.97958383082613], [32.905495727938842, 143.74759287325199], [41.548602943722187, 184.11191523512548], [57.134123028769864, 212.96132714313779], [85.982596883100427, 233.23682483532389], [116.34553106231533, 252.07189468414344], [153.54377487815492, 254.19994252292111], [184.09352786394243, 250.19280744913965], [210.84006513830786, 231.78958626538036], [230.33265432712187, 207.95546707713771], [242.54473105521458, 181.16454996007155], [245.32603716786156, 139.23222747588432], [253.95701774571654, 105.75356333489501], [250.16872236069304, 65.614622446558542], [234.42162441623111, 41.376144700389091], [218.06038382338016, 36.763971825401342], [195.01785757186678, 35.830381277151389], [173.22532214596566, 34.948429471706561], [54.903911233483029, 46.44126936726903], [74.831645200221715, 38.453426351873134], [97.147393013378746, 35.780078496224263], [124.15086404891906, 35.195299880035805], [66.35520762891224, 68.235316884765297], [88.846275187033712, 57.941876489833845], [109.10692456289365, 65.835365585188669], [89.15198347590956, 71.177597719421669], [88.362391942502256, 64.59180321109983], [223.52418336992747, 66.464653942855051], [200.72181416528224, 58.073962248085365], [180.51423847597891, 65.002569315598549], [201.60598302791442, 70.107080712007587], [201.4188717262528, 64.775640131702488], [151.03576003916953, 45.081162477481598], [123.46403491514627, 106.14140125029522], [119.73138344106076, 117.43345384315626], [125.15573426423208, 129.00558710238695], [156.06226938811682, 127.12365384578027], [178.19840010320991, 126.83676679574947], [183.26702924895841, 115.66950743874682], [175.51141450984255, 106.54676093041451], [151.75947907777766, 76.366817652668487], [133.66421579983097, 119.32339634260134], [172.1834824765383, 119.87854085001544], [107.48695740367185, 177.84786130901512], [119.72239618002311, 163.21478187250497], [140.4464890346631, 155.71112137112985], [155.86678473236145, 157.98177593573888], [167.21471198020845, 154.86495601683998], [180.68374974978832, 159.73999260624254], [190.76005528035921, 174.67434883370834], [180.73253431596419, 176.39562238973116], [169.53742410945182, 178.06866551441919], [155.53681594702357, 179.73851637572324], [141.80213459545843, 178.11191356675113], [126.33903348640217, 177.0074496842052], [132.38439794118267, 166.9144754158774], [154.18525275215882, 167.75142144628433], [171.26254237748122, 167.51576938990513], [172.534822324375, 166.51169079958765], [154.17356764276303, 166.77640382116056], [132.74611931034815, 165.54314795883778], [153.13151808703924, 107.35065481861218], [75.600007764156032, 61.08502670255362], [100.47692695245246, 59.887169821044154], [99.128136594613807, 69.002790596812332], [76.251785226012998, 71.202785857452454], [213.62188629502043, 60.266713925593479], [190.61716649430633, 59.53824381943511], [190.06078776389984, 69.052650607094705], [212.06614469025487, 68.784081158860744]],
    "sub-chuck": [[23.985805140787811, 59.253092736495404], [27.152914142356281, 93.63850488776103], [34.01220073959206, 124.65777588132323], [43.185644242726241, 161.9772579423547], [61.209744322279292, 192.42432570956339], [81.37821841704411, 220.37100316087003], [107.92580934104717, 237.80975318878194], [140.88839198974878, 241.278807347677], [167.70469646738874, 234.01970282186772], [186.12365924246313, 213.70594260547796], [202.80437939194087, 190.64053826009655], [217.69508138129819, 155.70072689125635], [221.02696388149508, 119.50512599746469], [227.99422254386025, 81.43151669889221], [227.11130532385494, 46.18417717200532], [207.21555625045997, 33.175332640476], [194.56294229742934, 28.937253432404674], [174.00649178397012, 27.028488506511849], [156.47566594458243, 32.350419791450179], [47.532877369699492, 42.421078138488781], [63.923256040387145, 34.721870564834518], [84.521999671791235, 28.68707065058706], [101.15791969739783, 30.213188331517443], [70.764074281840976, 51.416777160605335], [86.002488801591127, 44.424929334942277], [102.96119178404712, 53.160641855627574], [85.60397397751052, 55.234740063145978], [86.010308656883879, 49.899172374324678], [190.92358255141565, 49.397451262299313], [175.1523746520156, 41.900642395463876], [158.44345834031955, 52.154661706767172], [176.47309137989373, 53.014180036617432], [174.43308832832275, 47.307219358571558], [132.46182130918601, 45.48437589722576], [108.69786009928927, 99.545905831905316], [103.11665337522604, 113.75249817536462], [111.34508738112095, 123.58043415652844], [140.30363074789989, 128.37262124829522], [163.09709355203404, 119.0354984962861], [168.93097359374573, 108.93962862026251], [163.17674412901442, 97.84644989180623], [136.28156859047635, 77.887545322684673], [121.70408833473726, 123.07084388960436], [155.85885440334405, 121.00625017414006], [95.996752168226521, 161.32424774652623], [110.17525522629637, 156.4703757753677], [124.30175841524158, 153.55515190825861], [138.00204524415497, 153.64274134883692], [150.79297368282508, 150.23231929252609], [162.7406848240513, 149.85132514087474], [176.07303322566077, 151.81058946642867], [168.83777545300831, 164.0342671400889], [155.10895519199389, 171.80029333476506], [138.09166004169032, 175.18545713793497], [123.90094363765843, 175.40470843963408], [108.39952344275034, 170.40601225857262], [119.72606830073107, 167.28994293469788], [137.95384981384524, 168.64939698384137], [158.54405813052577, 165.50059529860471], [157.88012349108675, 151.99297197119006], [138.30132055467104, 157.65544747958882], [117.83502139036227, 157.58320456094589], [138.43867461393214, 113.41758462162812], [75.885110165472895, 46.920392101397766], [96.982049671082919, 46.292338804561751], [93.782070842166888, 54.197829817186403], [77.685715189360593, 54.825324576762569], [183.53723703826685, 44.14812614348557], [166.29837686271119, 44.526609395251143], [167.45958694297553, 52.084354270786775], [183.69784620690714, 51.704878940413039]],
    "sub-walter": [[21.060764903593935, 23.625922265374243], [24.306589250104111, 82.418736978583837], [29.887480558415291, 123.52324050386761], [39.831216823892362, 169.58896662877407], [56.335070257713795, 208.02264871738436], [80.83703098412272, 239.09972028159933], [112.71581076572778, 260.86442641371349], [148.15849351544631, 266.69887307481594], [187.92956781495144, 259.94808309698487], [224.28242219428836, 232.92409488998584], [248.61360434331704, 197.4132216415324], [267.6255386426007, 159.22848713841142], [274.06946800796993, 115.04205523453288], [279.57264995946605, 75.577994810142314], [274.8147191886797, 27.93465035602847], [243.21321805049308, 34.977887137176154], [222.77074074138181, 27.896989700591064], [190.0620481119081, 30.307609477713669], [159.27010163455151, 35.824855447032391], [51.033153870664592, 38.112001064409583], [75.392081525881991, 35.207713004503645], [102.74022206320058, 37.331330371284338], [124.56616025441463, 38.787179979952285], [67.451381950900242, 57.279940574514285], [90.044614607889713, 50.578228454933793], [111.78861952878373, 57.042466275764184], [90.903644751441476, 61.901327302928138], [90.715389774152072, 55.427091197335699], [223.99115821955013, 52.230403503055442], [205.18136904851377, 47.795771446298119], [184.90200898390299, 54.36443314080293], [204.67995257670333, 57.277939005103178], [204.92195881859544, 50.712535873236902], [146.50907007729293, 46.432109337738268], [115.95255333726485, 107.46593045529727], [109.22792349913794, 119.47849063536196], [117.00821443824393, 134.84341026421072], [145.67296091894715, 139.65462387898862], [173.67398162073596, 137.75538299827045], [185.00619633858076, 121.44588720141769], [180.64955597511778, 108.4547161320798], [147.27934367148265, 85.136485659341048], [124.32188592953989, 129.20306658959251], [167.29393856301289, 130.98984492081911], [101.59640357940233, 178.49694962096316], [118.21488930910681, 170.49617831223611], [139.18293919359641, 169.52754924913722], [151.13320163675684, 173.77693897734923], [167.32315821430757, 170.41084550370888], [182.37144722622213, 172.04427561978318], [198.17756373260085, 178.48935722147763], [184.440295252439, 186.17852019611308], [168.46308888233028, 189.07826517145685], [149.98168191113766, 189.67271148067312], [131.94804230553046, 187.67924933109754], [115.53452060145878, 185.3486212656689], [126.11701238101571, 180.30913427171828], [151.51451552828283, 182.42858464837599], [175.33473635294803, 181.769054498201], [176.96189091245589, 177.03898480289513], [151.40990278903843, 177.58200927291426], [127.15568541835768, 176.24970135595123], [147.26055194223767, 122.55189537474888], [74.747311503817315, 52.428814802906686], [103.91716767645684, 51.310986682531166], [102.84404568037712, 59.974636811905299], [76.675078380855666, 60.093874542162325], [216.58585024902322, 47.512012033316537], [190.54061564242585, 48.580342228676585], [191.79112935486376, 55.322342001097468], [214.83596488608993, 56.255513236279938]],
    "sub-audrey": [[29.74201740403646, 63.58838131299683], [32.135740245991599, 98.613580728522948], [39.926486700973527, 142.66741859878613], [46.051376346280165, 185.19751106090678], [63.623885970848306, 221.21082623221213], [92.686071409745011, 246.75195165866961], [124.31266068980059, 268.32269819176895], [159.08115584618832, 276.8182094669599], [193.01372611356055, 271.19451253588267], [220.73964850426626, 251.23315855606597], [249.37653785044409, 220.99473411123051], [262.56272926082778, 184.02931054521218], [274.46785237450297, 145.09243674243754], [286.71422071660493, 100.2191807024135], [287.7724614993711, 67.093735883445845], [273.08419909909355, 58.949447547158684], [250.35119471727239, 46.547177746833199], [227.88483875688155, 51.863141039656796], [201.92763554902524, 54.635918821225715], [50.207093876417957, 43.532664996747542], [78.106228477816103, 39.524315405279566], [110.54774174250323, 45.635392409130048], [135.80324104447095, 54.83859321342041], [80.208953800441719, 83.486704599142797], [103.2843062554636, 71.77563604011084], [130.37335751351947, 93.351828892065782], [101.37155395907916, 97.268693939422747], [103.77768051230873, 78.554240071733545], [246.69639088723869, 90.839855800811847], [225.25431248616547, 79.371020311284838], [200.21435196089101, 98.005155765703194], [227.73999275494873, 103.13681628226215], [226.06528007794577, 84.737881341868274], [170.2704842069295, 87.241173044027562], [136.73140157570418, 155.55089637183414], [132.09382016348263, 166.28137163294355], [141.43437220076765, 179.71853115783472], [168.84018353954804, 185.51893631975383], [195.57024175323983, 180.96444682513931], [200.63701169781223, 171.50291787670471], [196.03834636609736, 155.55926335687627], [171.53575860945466, 129.05860619902546], [151.91223102812063, 171.32412239283428], [186.99889102154822, 171.94139857304066], [117.36179100195926, 210.57248720067804], [132.24409741439899, 205.79192498435566], [151.95455263416062, 203.25064014467529], [165.61565000621329, 208.18658812822247], [181.73633661629219, 204.11786374216797], [194.71091994807995, 208.09809058994574], [208.15078953905629, 212.57790820835453], [193.07898694502654, 226.67843340292291], [179.59750146882573, 236.19115922247897], [163.22005286691325, 238.45845823523985], [145.14731000170292, 234.92524246489165], [132.35629580062368, 227.3232920714367], [145.46895415593832, 215.5609803328374], [164.98592388769322, 216.32998112652183], [182.14032562432749, 217.3077976017484], [183.73772138569666, 217.00947047307966], [164.55379748244519, 216.51396287362655], [145.7179313684785, 215.79854206584145], [171.13908085531165, 165.20445766092308], [88.246693449260022, 75.136292959533421], [119.33001418358253, 80.065297266301059], [116.37014577148472, 95.815825381060108], [88.287291370337073, 92.88465259927068], [240.47641466360238, 82.609923128584455], [208.73309300337735, 86.192129111264819], [212.47694784065465, 102.57941207015807], [240.22165570085622, 99.99430087462639]]
};
var FACE_SUB_EXTENDED_VERTICES = [
    [0, 71, 72, 0],
    [0, 72, 1, 0],
    [1, 72, 73, 1],
    [1, 73, 2, 1],
    [2, 73, 74, 2],
    [2, 74, 3, 2],
    [3, 74, 75, 3],
    [3, 75, 4, 3],
    [4, 75, 76, 4],
    [4, 76, 5, 4],
    [5, 76, 77, 5],
    [5, 77, 6, 5],
    [6, 77, 78, 6],
    [6, 78, 7, 6],
    [7, 78, 79, 7],
    [7, 79, 8, 7],
    [8, 79, 80, 8],
    [8, 80, 9, 8],
    [9, 80, 81, 9],
    [9, 81, 10, 9],
    [10, 81, 82, 10],
    [10, 82, 11, 10],
    [11, 82, 83, 11],
    [11, 83, 12, 11],
    [12, 83, 84, 12],
    [12, 84, 13, 12],
    [13, 84, 85, 13],
    [13, 85, 14, 13],
    [14, 85, 86, 14],
    [14, 86, 15, 14],
    [15, 86, 87, 15],
    [15, 87, 16, 15],
    [16, 87, 88, 16],
    [16, 88, 17, 16],
    [17, 88, 89, 17],
    [17, 89, 18, 17],
    [18, 89, 90, 18],
    [18, 90, 22, 18],
    [22, 90, 21, 22],
    [21, 90, 91, 21],
    [21, 20, 91, 21],
    [20, 91, 92, 20],
    [20, 92, 19, 20],
    [19, 92, 93, 19],
    [19, 93, 71, 19],
    [19, 0, 71, 19],
    [44, 61, 56, 44],
    [60, 61, 56, 60],
    [60, 56, 57, 60],
    [60, 59, 57, 60],
    [58, 59, 57, 58],
    [58, 59, 50, 58]
];
/* -----------------------------------------
 Declare the usage of face deformation.
 -------------------------------------------- */
var FACE_DEFORM_MOUTH_VERTICES = [
    [44, 45, 61, 44],
    [45, 46, 61, 45],
    [46, 60, 61, 46],
    [46, 47, 60, 46],
    [47, 48, 60, 47],
    [48, 59, 60, 48],
    [48, 49, 59, 48],
    [49, 50, 59, 49],
    [50, 51, 58, 50],
    [51, 52, 58, 51],
    [52, 57, 58, 52],
    [52, 53, 57, 52],
    [53, 54, 57, 53],
    [54, 56, 57, 54],
    [54, 55, 56, 54],
    [55, 44, 56, 55],
    [44, 61, 56, 44],
    [61, 60, 56, 61],
    [56, 57, 60, 56],
    [57, 59, 60, 57],
    [57, 58, 59, 57],
    [50, 58, 59, 50],
];
var FACE_DEFORM_EXTENDED_VERTICES = [
    [0, 71, 72, 0],
    [0, 72, 1, 0],
    [1, 72, 73, 1],
    [1, 73, 2, 1],
    [2, 73, 74, 2],
    [2, 74, 3, 2],
    [3, 74, 75, 3],
    [3, 75, 4, 3],
    [4, 75, 76, 4],
    [4, 76, 5, 4],
    [5, 76, 77, 5],
    [5, 77, 6, 5],
    [6, 77, 78, 6],
    [6, 78, 7, 6],
    [7, 78, 79, 7],
    [7, 79, 8, 7],
    [8, 79, 80, 8],
    [8, 80, 9, 8],
    [9, 80, 81, 9],
    [9, 81, 10, 9],
    [10, 81, 82, 10],
    [10, 82, 11, 10],
    [11, 82, 83, 11],
    [11, 83, 12, 11],
    [12, 83, 84, 12],
    [12, 84, 13, 12],
    [13, 84, 85, 13],
    [13, 85, 14, 13],
    [14, 85, 86, 14],
    [14, 86, 15, 14],
    [15, 86, 87, 15],
    [15, 87, 16, 15],
    [16, 87, 88, 16],
    [16, 88, 17, 16],
    [17, 88, 89, 17],
    [17, 89, 18, 17],
    [18, 89, 93, 18],
    [18, 93, 22, 18],
    [22, 93, 21, 22],
    [93, 92, 21, 93],
    [21, 92, 20, 21],
    [92, 91, 20, 92],
    [20, 91, 19, 20],
    [91, 90, 19, 91],
    [19, 90, 71, 19],
    [19, 71, 0, 19]
];
/**
 * Created by chendi on 2/12/17.
 */
var pxsim;
(function (pxsim) {
    var detector;
    (function (detector) {
        /**
         * Act on sentiment
         *
         * @param sentiment
         * @param handler
         */
        //% weight=100
        //% blockId=onsentiment block="on sentiment %sentiment"
        function onSentiment(sentiment, handler) {
            pxsim.runtimeStateFactory().isOnDetecting = true;
            pxsim.runtimeStateFactory().bus.listen("sentiment", sentiment, handler);
        }
        detector.onSentiment = onSentiment;
        /**
         * Act on sentiment
         *
         * @param gender
         * @param handler
         */
        //% weight=100
        //% blockId=ongender block="on gender %gender"
        function onGender(gender, handler) {
            pxsim.runtimeStateFactory().isOnDetecting = true;
            pxsim.runtimeStateFactory().bus.listen("gender", gender, handler);
        }
        detector.onGender = onGender;
        /**
         * Act on mouth open or close
         *
         * @param mouthStatus
         * @param hander
         */
        //% weight=100
        //% blockId=onmouthstatus block="on mouth %mouthStatus"
        function onMouthStatus(mouthStatus, handler) {
            pxsim.runtimeStateFactory().isOnDetecting = true;
            pxsim.runtimeStateFactory().bus.listen("mouthStatus", mouthStatus, handler);
        }
        detector.onMouthStatus = onMouthStatus;
        /**
         * Detect sentiment
         */
        //%
        function detectSentiment() {
            var sentimentList = pxsim.runtimeStateFactory().getFaceEmotionList();
            if (sentimentList && sentimentList.length != 0) {
                var currentSentiment = pxsim.runtimeStateFactory().getTopEmotion(sentimentList);
                if (currentSentiment.value > pxsim.runtimeStateFactory().faceEmotionThreshold) {
                    pxsim.runtimeStateFactory().bus.queue("sentiment", currentSentiment.sentiment);
                }
            }
        }
        detector.detectSentiment = detectSentiment;
        /**
         * Detect MouthStatus
         */
        //%
        function detectMouthStatus() {
            if (pxsim.runtimeStateFactory().isMouthOpen()) {
                pxsim.runtimeStateFactory().bus.queue("mouthStatus", 0 /* Open */);
            }
            else {
                pxsim.runtimeStateFactory().bus.queue("mouthStatus", 1 /* Close */);
            }
        }
        detector.detectMouthStatus = detectMouthStatus;
        /**
         * Detect Gender
         */
        //%
        function detectGender() {
            var genderList = pxsim.runtimeStateFactory().getGenderPredictionList();
            if (genderList && genderList.length != 0) {
                var topGender = pxsim.runtimeStateFactory().getTopGender(genderList);
                pxsim.runtimeStateFactory().bus.queue("gender", topGender);
            }
        }
        detector.detectGender = detectGender;
        /**
         * isFaceLeanLeft
         *
         * @param leftRight
         */
        //% weight=100
        //% blockId=isFaceLeanLeft block="is face lean %leftRight"
        function faceLean(leftRight) {
            if (leftRight == 0 /* Left */) {
                return pxsim.runtimeStateFactory().isFaceLeanLeft();
            }
            else {
                return pxsim.runtimeStateFactory().isFaceLeanRight();
            }
        }
        detector.faceLean = faceLean;
        /**
         * get face center X position
         *
         */
        //% weight=100
        //% blockId=getFaceHorizontalPosition block="get face horizontal position"
        //% advanced=true
        function getFaceXPosition() {
            return pxsim.runtimeStateFactory().getFaceCenterXPosition();
        }
        detector.getFaceXPosition = getFaceXPosition;
        /**
         * get face center Y position
         *
         */
        //% weight=100
        //% blockId=getFaceVerticalPosition block="get face vertical position"
        //% advanced=true
        function getFaceYPosition() {
            return pxsim.runtimeStateFactory().getFaceCenterYPosition();
        }
        detector.getFaceYPosition = getFaceYPosition;
        /*
         * Tracking convergence
         *
         * This function indicates how well the face is being tracked.
         * The smaller the number, the better the tracking results.
         * */
        //% block="get tracking convergence" blockId="get_track_conv"
        //% weight=90
        //% advanced=true
        function getTrackingConvergence() {
            return pxsim.runtimeStateFactory().getMaskConvergence();
        }
        detector.getTrackingConvergence = getTrackingConvergence;
    })(detector = pxsim.detector || (pxsim.detector = {}));
})(pxsim || (pxsim = {}));
/**
 * Created by chendi on 2/12/17.
 */
var pxsim;
(function (pxsim) {
    var gaming;
    (function (gaming) {
        /**
         * Drop ball catcher
         *
         * @param speed
         */
        //% weight=100
        //% blockId=onballdrop block="on ball drop speed %speed"
        function onBallDrop(speed, handler) {
            pxsim.runtimeStateFactory().isOnDetecting = true;
            if (speed == 0 /* Slow */) {
                pxsim.runtimeStateFactory().ballDropSpeed = 0 /* Slow */;
            }
            else if (speed == 1 /* Medium */) {
                pxsim.runtimeStateFactory().ballDropSpeed = 1 /* Medium */;
            }
            else {
                pxsim.runtimeStateFactory().ballDropSpeed = 2 /* Fast */;
            }
            pxsim.runtimeStateFactory().gameShowBall();
            pxsim.runtimeStateFactory().bus.listen("gameBallDrop", 0 /* ValueHolder */, handler);
        }
        gaming.onBallDrop = onBallDrop;
        /**
         * get ball x position
         */
        //% weight=100
        //% blockId=getBallXPos block="get ball horizontal position"
        //% advanced=true
        function getBallXPos() {
            return pxsim.runtimeStateFactory().sprite.x;
        }
        gaming.getBallXPos = getBallXPos;
        /**
         * get ball y position
         */
        //% weight=100
        //% blockId=getBallYPos block="get ball vertical position"
        //% advanced=true
        function getBallYPos() {
            return pxsim.runtimeStateFactory().sprite.y;
        }
        gaming.getBallYPos = getBallYPos;
        /**
         * check if ball hit mouth
         */
        //% weight=100
        //% blockId=ifBallHitMouth block="is ball hitting mouth"
        function ifBallHitMouth() {
            var point1X = pxsim.runtimeStateFactory().sprite.x;
            var point1Y = pxsim.runtimeStateFactory().sprite.y;
            var point1 = [point1X, point1Y];
            var point2X = pxsim.runtimeStateFactory().getMouthXPosition();
            var point2Y = pxsim.runtimeStateFactory().getMouthYPosition();
            var point2 = [point2X, point2Y];
            var distance = pxsim.runtimeStateFactory().getCartesianDistance(point1, point2);
            return distance < pxsim.runtimeStateFactory().sprite.r * 2;
        }
        gaming.ifBallHitMouth = ifBallHitMouth;
        /**
         * check if ball hit nose
         */
        //% weight=100
        //% blockId=ifBallHitNose block="is ball hitting nose"
        function ifBallHitNose() {
            var point1X = pxsim.runtimeStateFactory().sprite.x;
            var point1Y = pxsim.runtimeStateFactory().sprite.y;
            var point1 = [point1X, point1Y];
            var point2X = pxsim.runtimeStateFactory().getFaceCenterXPosition();
            var point2Y = pxsim.runtimeStateFactory().getFaceCenterYPosition();
            var point2 = [point2X, point2Y];
            var distance = pxsim.runtimeStateFactory().getCartesianDistance(point1, point2);
            return distance < pxsim.runtimeStateFactory().sprite.r * 2;
        }
        gaming.ifBallHitNose = ifBallHitNose;
        /**
         * Drop ball
         */
        //%
        function dropBall() {
            if (pxsim.runtimeStateFactory().gameBallOn == true) {
                pxsim.runtimeStateFactory().dropBall();
                pxsim.runtimeStateFactory().bus.queue("gameBallDrop", 0 /* ValueHolder */);
            }
        }
        gaming.dropBall = dropBall;
    })(gaming = pxsim.gaming || (pxsim.gaming = {}));
})(pxsim || (pxsim = {}));
/// <reference path="../node_modules/pxt-core/typings/globals/bluebird/index.d.ts"/>
/// <reference path="../node_modules/pxt-core/built/pxtsim.d.ts"/>
/// <reference path="../sim/canvas-datapoints.ts"/>
/* -----------------------------------------
    Declare the usage of clmtrackr library.
    Initialize video & clmtrackr library only once
-------------------------------------------- */
var FaceDetector = pxsim.BuildUFace;
// Get Video Elements
var VIDEO = document.getElementById('videoel');
var OVERLAY = document.getElementById('overlay');
var WEBGL = document.getElementById('webgl');
var WEBGL_2 = document.getElementById('webgl2');
var P_MODEL = pModel;
var POISSON = Poisson;
var VID_WIDTH = 400;
var VID_HEIGHT = 300;
// set eigenvector 9 and 11 to not be regularized. This is to better detect motion of the eyebrows
P_MODEL.shapeModel.nonRegularizedVectors.push(9);
P_MODEL.shapeModel.nonRegularizedVectors.push(11);
// Initialize tracker;
var CLM_TRACKR = new clm.tracker({ useWebGL: true });
var FACE_DEFORMER = new faceDeformer();
var FACE_DEFORMER_2 = new faceDeformer();
var EMOTION_CLASSIFIER = new emotionClassifier();
var GENDER_CLASSIFIER = new emotionClassifier();
// Face substitution canvases
var faceSubImageCanvases = {};
/* -----------------------------------------
    Setup drawing canvas for face substitution
 -------------------------------------------- */
// canvas for copying the warped face to
var NEW_CANVAS = document.createElement('CANVAS');
NEW_CANVAS.width = VID_WIDTH;
NEW_CANVAS.height = VID_HEIGHT;
// canvas for copying videoframes to
var VIDEO_CANVAS = document.createElement('CANVAS');
VIDEO_CANVAS.width = VID_WIDTH;
VIDEO_CANVAS.height = VID_HEIGHT;
// canvas for masking
var FACE_SUB_CANVAS = document.createElement('CANVAS');
FACE_SUB_CANVAS.width = VID_WIDTH;
FACE_SUB_CANVAS.height = VID_HEIGHT;
/* ------------------------------------------
    Start Video
 ------------------------------------------ */
navigator.getUserMedia({ video: true }, gumSuccess.bind(this), gumFailed);
/* -----------------------------------------
    Load face substitution images
 -------------------------------------------- */
// This function load inidividual face substitution masks
function loadFaceSubMask(index) {
    var mask = new Image();
    mask.onload = function (obj) {
        var elementId = SUBSTITUTION_IMAGES[index].id;
        //var elementId = 'sub-average';
        // copy the images to canvases
        var childSubImage = document.createElement('CANVAS');
        childSubImage.width = obj.target.width;
        childSubImage.height = obj.target.height;
        childSubImage.getContext('2d').drawImage(obj.target, 0, 0);
        faceSubImageCanvases[elementId] = childSubImage;
    };
    mask.src = SUBSTITUTION_IMAGES[index].path;
}
// This function loads whole masks media library
function loadFaceSubMasksLibrary() {
    for (var i = 0; i < SUBSTITUTION_IMAGES.length; i++) {
        loadFaceSubMask(i);
    }
}
/* ------------------------------------------
    Video success / fail handler
 ------------------------------------------ */
function gumSuccess(stream) {
    VIDEO.src = window.URL.createObjectURL(stream);
    VIDEO.play();
    // Start Tracking
    CLM_TRACKR.init(P_MODEL);
    EMOTION_CLASSIFIER.init(emotionModel);
    GENDER_CLASSIFIER.init(genderModel);
    CLM_TRACKR.start(VIDEO);
    FACE_DEFORMER.init(WEBGL);
    FACE_DEFORMER_2.init(WEBGL_2);
    // Load face substitution library
    loadFaceSubMasksLibrary();
}
function gumFailed() {
    console.log("There was some problem trying to fetch video from your webcam");
}
var pxsim;
(function (pxsim) {
    /**
     * This function gets called each time the program restarts
     */
    pxsim.initCurrentRuntime = function () {
        pxsim.runtime.board = new BuildUFace(VIDEO, OVERLAY, WEBGL, WEBGL_2, CLM_TRACKR);
    };
    /**
     * Gets the current 'board', eg. program state.
     */
    function runtimeStateFactory() {
        return pxsim.runtime.board;
    }
    pxsim.runtimeStateFactory = runtimeStateFactory;
    /**
     * Represents the entire state of the executing program.
     * Do not store state anywhere else!
     */
    var BuildUFace = (function (_super) {
        __extends(BuildUFace, _super);
        function BuildUFace(video, overlay, webgl, webgl2, clmtrackr) {
            _super.call(this);
            this.isOnDetecting = false;
            this.MOUTH_STATUS = 0 /* ValueHolder */;
            this.EMOTION_STATUS = 0 /* ValueHolder */;
            this.convergenceRatio = 0.6;
            this.shouldContinueMask = false;
            this.faceEmotionThreshold = 0.2;
            this.mouthOpenRatio = 0.25;
            this.faceLeanLeftTangentThreshold = -4;
            this.faceLeanRightTangentThreshold = 4;
            this.gameBallOn = false;
            this.ballDropSpeed = 0 /* Slow */;
            this.numOfBalls = 0;
            this.video = video;
            this.video_width = VID_WIDTH;
            this.video_height = VID_HEIGHT;
            this.overlay = overlay;
            this.overlayCC = this.overlay.getContext('2d');
            this.webGL = webgl;
            this.webGL2 = webgl2;
            this.webGLContext = this.webGL.getContext('webgl');
            this.webGLContext2 = this.webGL2.getContext('webgl');
            this.clmtrackr = clmtrackr;
            this.bus = new pxsim.EventBus(pxsim.runtime);
            this.element = document.getElementById('svgcanvas');
            this.spriteElement = this.element.getElementById('svgsprite');
            this.spriteElement.style.visibility = "hidden";
            this.sprite = new pxsim.Sprite();
        }
        BuildUFace.prototype.clearCanvas = function () {
            this.overlayCC.clearRect(0, 0, this.video_width, this.video_height);
            this.webGLContext.clearColor(0.0, 0.0, 0.0, 0.0);
            this.webGLContext.clear(this.webGLContext.COLOR_BUFFER_BIT);
            this.webGLContext2.clearColor(0.0, 0.0, 0.0, 0.0);
            this.webGLContext2.clear(this.webGLContext2.COLOR_BUFFER_BIT);
        };
        // This function get face emotion
        BuildUFace.prototype.getFaceEmotionList = function () {
            var cp = this.clmtrackr.getCurrentParameters();
            var emotionList = EMOTION_CLASSIFIER.meanPredict(cp);
            return emotionList;
        };
        // This function get gender prediction
        BuildUFace.prototype.getGenderPredictionList = function () {
            var cp = this.clmtrackr.getCurrentParameters();
            var genderList = GENDER_CLASSIFIER.meanPredict(cp);
            return genderList;
        };
        BuildUFace.prototype.getTopGender = function (genderList) {
            if (genderList[0].value > genderList[1].value) {
                return 1 /* Female */;
            }
            else {
                return 0 /* Male */;
            }
        };
        BuildUFace.prototype.getFaceCenterXPosition = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                return positions[62][0];
            }
            else {
                return -1;
            }
        };
        BuildUFace.prototype.getFaceCenterYPosition = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                return positions[62][1];
            }
            else {
                return -1;
            }
        };
        BuildUFace.prototype.getTopEmotion = function (sentimentList) {
            var topSentimentPair = { sentiment: 5 /* Angry */, value: -1 };
            for (var _i = 0, sentimentList_1 = sentimentList; _i < sentimentList_1.length; _i++) {
                var eachEmotion = sentimentList_1[_i];
                if (eachEmotion.value > topSentimentPair.value) {
                    topSentimentPair.sentiment = this.getSentimentEnum(eachEmotion.emotion);
                    topSentimentPair.value = eachEmotion.value;
                }
            }
            return topSentimentPair;
        };
        BuildUFace.prototype.getSentimentEnum = function (sentiment) {
            switch (sentiment) {
                case "happy":
                    return 0 /* Happy */;
                case "surprised":
                    return 2 /* Surprised */;
                case "sad":
                    return 1 /* Sad */;
                case "fear":
                    return 3 /* Fear */;
                case "disgusted":
                    return 4 /* Disgusted */;
                default:
                    return 5 /* Angry */;
            }
        };
        // This function draws face outline
        BuildUFace.prototype.drawFaceOutlineAsync = function () {
            var _this = this;
            this.clearCanvas();
            if (this.clmtrackr.getCurrentPosition()) {
                this.clmtrackr.draw(this.overlay);
            }
            if (this.isOnDetecting) {
                return Promise.delay(50).then(function () { _this.clearCanvas(); });
            }
            else {
                return Promise.delay(50);
            }
        };
        // This function draws a Mask
        BuildUFace.prototype.drawFaceMasksAsync = function (mask) {
            var _this = this;
            this.clearCanvas();
            this.mask = mask;
            // get current mask
            FACE_DEFORMER.load(document.getElementById(this.mask), MASKS[this.mask], P_MODEL);
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                // draw mask on top of face
                FACE_DEFORMER.draw(positions);
            }
            if (this.isOnDetecting) {
                return Promise.delay(50).then(function () { _this.clearCanvas(); });
            }
            else {
                return Promise.delay(50);
            }
        };
        // This function load face substitution
        BuildUFace.prototype.drawFaceSubstitutionAsync = function (face) {
            var _this = this;
            this.clearCanvas();
            this.curFaceSubMask = face;
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                this.subSwitchMasks(positions);
            }
            if (this.isOnDetecting) {
                return Promise.delay(50).then(function () { _this.clearCanvas(); });
            }
            else {
                return Promise.delay(50);
            }
        };
        BuildUFace.prototype.subSwitchMasks = function (pos) {
            VIDEO_CANVAS.getContext('2d').drawImage(this.video, 0, 0, VIDEO_CANVAS.width, VIDEO_CANVAS.height);
            // we need to extend the positions with new estimated points in order to get pixels immediately outside mask
            var newMaskPos = SUBSTITUTION_ANCHORPOINTS[this.curFaceSubMask].slice(0);
            var newFacePos = pos.slice(0);
            var extInd = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 22, 21, 20, 19];
            var newp;
            for (var i = 0; i < 23; i++) {
                newp = [];
                newp[0] = (newMaskPos[extInd[i]][0] * 1.3) - (newMaskPos[62][0] * 0.3); // short for ((newMaskPos[extInd[i]][0]-newMaskPos[62][0])*1.1)+newMaskPos[62][0]
                newp[1] = (newMaskPos[extInd[i]][1] * 1.3) - (newMaskPos[62][1] * 0.3);
                newMaskPos.push(newp);
                newp = [];
                newp[0] = (newFacePos[extInd[i]][0] * 1.3) - (newFacePos[62][0] * 0.3);
                newp[1] = (newFacePos[extInd[i]][1] * 1.3) - (newFacePos[62][1] * 0.3);
                newFacePos.push(newp);
            }
            // also need to make new vertices incorporating area outside mask
            var newVertices = P_MODEL.path.vertices.concat(FACE_SUB_EXTENDED_VERTICES);
            // deform the mask we want to use to face form
            FACE_DEFORMER_2.load(faceSubImageCanvases[this.curFaceSubMask], newMaskPos, P_MODEL, newVertices);
            FACE_DEFORMER_2.draw(newFacePos);
            // and copy onto new canvas
            NEW_CANVAS.getContext('2d').drawImage(document.getElementById('webgl2'), 0, 0);
            // create masking
            var positions = this.clmtrackr.getCurrentPosition();
            var tempcoords = positions.slice(0, 18);
            tempcoords.push(positions[21]);
            tempcoords.push(positions[20]);
            tempcoords.push(positions[19]);
            this.createMasking(FACE_SUB_CANVAS, tempcoords);
            // do poisson blending
            POISSON.load(NEW_CANVAS, VIDEO_CANVAS, FACE_SUB_CANVAS, function () {
                var result = POISSON.blend(30, 0, 0);
                // render to canvas
                NEW_CANVAS.getContext('2d').putImageData(result, 0, 0);
                FACE_DEFORMER.load(NEW_CANVAS, pos, P_MODEL);
                requestAnimationFrame(this.subDrawMaskLoop.bind(this));
            }.bind(this));
        };
        BuildUFace.prototype.subDrawMaskLoop = function () {
            // get position of face
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                // draw mask on top of face
                FACE_DEFORMER.draw(positions);
            }
        };
        BuildUFace.prototype.drawFaceDeformAsync = function (deform_parameters) {
            var _this = this;
            this.clearCanvas();
            this.deform_parameters = deform_parameters;
            this.deformDrawMask();
            if (this.isOnDetecting) {
                return Promise.delay(50).then(function () { _this.clearCanvas(); });
            }
            else {
                return Promise.delay(50);
            }
        };
        BuildUFace.prototype.getMaskConvergence = function () {
            pxsim.console.log("Face Tracking Convergence: " + this.clmtrackr.getConvergence());
            return this.clmtrackr.getConvergence();
        };
        BuildUFace.prototype.deformDrawMask = function () {
            VIDEO_CANVAS.getContext('2d').drawImage(this.video, 0, 0, VIDEO_CANVAS.width, VIDEO_CANVAS.height);
            var pos = this.clmtrackr.getCurrentPosition();
            if (pos) {
                // create additional points around face
                var tempPos = void 0;
                var addPos = [];
                for (var i = 0; i < 23; i++) {
                    tempPos = [];
                    tempPos[0] = (pos[i][0] - pos[62][0]) * 1.3 + pos[62][0];
                    tempPos[1] = (pos[i][1] - pos[62][1]) * 1.3 + pos[62][1];
                    addPos.push(tempPos);
                }
                // merge with pos
                var newPos = pos.concat(addPos);
                var newVertices = P_MODEL.path.vertices.concat(FACE_DEFORM_MOUTH_VERTICES);
                // merge with newVertices
                newVertices = newVertices.concat(FACE_DEFORM_EXTENDED_VERTICES);
                FACE_DEFORMER.load(VIDEO_CANVAS, newPos, P_MODEL, newVertices);
                var parameters = this.clmtrackr.getCurrentParameters();
                var eig = void 0;
                for (var i = 0; i < this.deform_parameters.length; i++) {
                    //eig = -5*Math.sqrt(pModel.shapeModel.eigenValues[i])*3;
                    parameters[i + 5] += this.deform_parameters[i];
                }
                var positions = this.clmtrackr.calculatePositions(parameters);
                //this.clearCanvas();
                this.overlayCC.clearRect(0, 0, this.video_width, this.video_height);
                if (positions) {
                    // add positions from extended boundary, unmodified
                    newPos = positions.concat(addPos);
                    // draw mask on top of face
                    FACE_DEFORMER.draw(newPos);
                }
            }
        };
        BuildUFace.prototype.keepContinue = function () {
            this.shouldContinueMask = true;
        };
        BuildUFace.prototype.stopContinue = function () {
            this.clearCanvas();
            this.shouldContinueMask = false;
            cancelAnimationFrame(this.animationFrame);
            pxsim.console.log("STOP animation frame: " + this.animationFrame);
        };
        // This function creates masks
        BuildUFace.prototype.createMasking = function (canvas, modelpoints) {
            // fill canvas with black
            var cc = canvas.getContext('2d');
            cc.fillStyle = "#000000";
            cc.fillRect(0, 0, canvas.width, canvas.height);
            cc.beginPath();
            cc.moveTo(modelpoints[0][0], modelpoints[0][1]);
            for (var i = 1; i < modelpoints.length; i++) {
                cc.lineTo(modelpoints[i][0], modelpoints[i][1]);
            }
            cc.lineTo(modelpoints[0][0], modelpoints[0][1]);
            cc.closePath();
            cc.fillStyle = "#ffffff";
            cc.fill();
        };
        BuildUFace.prototype.getVertiHorizontalRatio = function (top, bottom, left, right, positions) {
            var posTop = positions[top];
            var posBottom = positions[bottom];
            var posLeft = positions[left];
            var posRight = positions[right];
            var vertiHorizontalRatio = this.getCartesianDistance(posTop, posBottom) /
                this.getCartesianDistance(posLeft, posRight);
            return vertiHorizontalRatio;
        };
        BuildUFace.prototype.getMouthOpenRadio = function (positions) {
            return this.getVertiHorizontalRatio(60, 57, 44, 50, positions);
        };
        BuildUFace.prototype.getCartesianDistance = function (coor1, coor2) {
            return Math.sqrt(Math.pow(coor1[0] - coor2[0], 2) +
                Math.pow(coor1[1] - coor2[1], 2));
        };
        BuildUFace.prototype.isMouthOpen = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                return this.getMouthOpenRadio(positions) > this.mouthOpenRatio;
            }
            else {
                return false;
            }
        };
        BuildUFace.prototype.isFaceLeanLeft = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                var tangent = this.getTangent(positions[33], positions[62]);
                return tangent > this.faceLeanLeftTangentThreshold && tangent < 0;
            }
            else {
                return false;
            }
        };
        BuildUFace.prototype.isFaceLeanRight = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                var tangent = this.getTangent(positions[33], positions[62]);
                return tangent < this.faceLeanRightTangentThreshold && tangent > 0;
            }
            else {
                return false;
            }
        };
        BuildUFace.prototype.getTangent = function (pointTop, pointBottom) {
            var vertical = pointTop[1] - pointBottom[1];
            var horizontal = pointTop[0] - pointBottom[0];
            return vertical / horizontal;
        };
        BuildUFace.prototype.gameShowBall = function () {
            this.gameBallOn = true;
            this.spriteElement.style.visibility = "visible";
        };
        BuildUFace.prototype.dropBall = function () {
            if (this.sprite.y > this.video_height) {
                this.sprite.x = Math.random() * this.video_width;
                this.sprite.y = 0;
            }
            else {
                if (this.ballDropSpeed == 0 /* Slow */) {
                    this.sprite.y += 1;
                }
                else if (this.ballDropSpeed == 1 /* Medium */) {
                    this.sprite.y += 3;
                }
                else {
                    this.sprite.y += 7;
                }
            }
            this.spriteElement.x.baseVal.value = this.sprite.x;
            this.spriteElement.y.baseVal.value = this.sprite.y;
        };
        BuildUFace.prototype.getMouthXPosition = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                return (positions[57][0] + positions[60][0]) / 2;
            }
            else {
                return -1;
            }
        };
        BuildUFace.prototype.getMouthYPosition = function () {
            var positions = this.clmtrackr.getCurrentPosition();
            if (positions) {
                return (positions[57][1] + positions[60][1]) / 2;
            }
            else {
                return -1;
            }
        };
        BuildUFace.prototype.getCartiseanDistance = function (point1, point2) {
            Math.sqrt(Math.pow(point1[0] - point2[0], 2) + Math.pow(point1[1] - point2[1], 2));
        };
        BuildUFace.prototype.initAsync = function (msg) {
            this.clearCanvas();
            return Promise.resolve();
        };
        return BuildUFace;
    }(pxsim.BaseBoard));
    pxsim.BuildUFace = BuildUFace;
})(pxsim || (pxsim = {}));
